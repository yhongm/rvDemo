!function(e){var t={};function i(r){if(t[r])return t[r].exports;var l=t[r]={i:r,l:!1,exports:{}};return e[r].call(l.exports,l,l.exports,i),l.l=!0,l.exports}i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)i.d(r,l,function(t){return e[t]}.bind(null,l));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){"use strict";var r,l=i(1),s=(r=l)&&r.__esModule?r:{default:r};var n=void 0;window.clickDiv=function(){n.data.parent="click Div time:"+new Date/1e3},window.clickP1=function(){n.data.child="click p1 time:"+new Date/1e3},window.clickP2=function(){n.data.child2="click p2 time:"+new Date/1e3},window.onload=function(){(n=new s.default({el:"#app",data:{parent:"parent",child:"child",pcolor:"red",c1color:"blue",c2color:"green",child2:"child2"},dom:{tag:"div",props:{key:"1",style:"color:%#pcolor#%,width:100px,height:100px",onclick:"clickDiv()"},children:["%#parent#%",{tag:"p",props:{key:"2",style:"color:%#c1color#%,width:50px,height:50px",onclick:"clickP1()"},children:["%#child#%"]},{tag:"p",props:{key:"3",style:"color:%#c2color#%,width:50px,height:50px",onclick:"clickP2()"},children:["%#child2#%"]}]}})).watch("parent",function(){alert("parent,change")}),n.watch("child",function(){alert("child,change")}),n.watch("child2",function(){alert("child2,change")})}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);const NODE_REPLACE=0,CHILD_RE_ORDER=1,NODE_PROPS=2,NODE_CONTENT=3;class Element{constructor(e,t,i){if(!(this instanceof Element))return new Element(tagName,t,i);if(this.tag=e,this.props=t||{},this.children=i||[],this.key=t?t.key:void 0,!this.key)throw new Error(`${e} ... html tag the key is undefined`);let r=0;this.children.forEach(e=>{e instanceof Element&&(r+=e.count),r++}),this.count=r}render(){const e=document.createElement(this.tag),t=this.props;for(const i in t)Util.setAttr(e,i,t[i]);return this.children.forEach(t=>{const i=t instanceof Element?t.render():document.createTextNode(t);e.appendChild(i)}),e}}class Diff{constructor(e,t){this.index=0,this.patches={},this.dfsWalk(e,t,this.index)}dfsWalk(e,t,i){let r=[];if(null==t);else if(Util.isString(e)&&Util.isString(t))e!=t&&r.push({type:NODE_CONTENT,content:t});else if(e.tagName===t.tagName&&e.key==t.key){let l=this.diffProps(e,t);l&&r.push({type:NODE_PROPS,props:l}),Util.isIgnoreChildren(t)||this.diffChildren(e.children,t.children,i,r)}else r.push({type:NODE_REPLACE,node:t});r.length&&(this.patches[i]=r)}diffProps(e,t){const i=e.props,r=t.props,l={};let s=!0;for(let e in i)r[e]!==i[e]&&(s=!1,l[e]=r[e]);for(let e in r)i.hasOwnProperty(e)||(s=!1,l[e]=r[e]);return s?null:l}diffChildren(e,t,i,r){let l=new DiffList(e,t).getResult();if(t=l.child,l.moves.length){let e={type:CHILD_RE_ORDER,moves:l.moves};r.push(e)}let s=null,n=i;e.forEach((e,i)=>{let r=t[i];n=s&&s.count?n+s.count+1:n+1,this.dfsWalk(e,r,n),s=e})}}class Patch{constructor(e,t){this.dfsWalk(e,{index:0},t)}dfsWalk(e,t,i){let r=i[t.index],l=e.childNodes?e.childNodes.length:0;for(let r=0;r<l;r++){let l=e.childNodes[r];t.index++,this.dfsWalk(l,t,i)}r&&this.applyPatches(e,r)}applyPatches(e,t){t.forEach(t=>{switch(t.type){case NODE_REPLACE:let i=Util.isString(t.node)?document.createTextNode(t.node):t.node.render();e.parentNode.replaceChild(i,e);break;case CHILD_RE_ORDER:this.reorderChildren(e,t.moves);break;case NODE_PROPS:this.setProps(e,t.props);break;case NODE_CONTENT:e.textContent?e.textContent=t.content:e.nodeValue=t.content}})}reorderChildren(e,t){let i=Util.toArray(e.childNodes),r={};i.forEach(e=>{if(1===e.nodeType){let t=e.getAttribute("key");t&&(r[t]=e)}}),t.forEach(t=>{let l=t.index;if(0===t.type)i[l]===e.childNodes[l]&&e.removeChild(e.childNodes[l]),i.splice(l,1);else if(1===t.type){let s=r[t.item.key]?r(t.item.key).cloneNode(!0):Util.isString(t.item)?document.createTextNode(t.item):t.item.render();i.splice(l,0,s),e.insertBefore(s,e.childNodes[l]||null)}})}setProps(e,t){for(let i in t)if(void 0===t[i])e.removeAttribute(i);else{const r=t[i];Util.setAttr(e,i,r)}}}class Util{static isString(e){return"string"==typeof e}static toArray(e){if(!e)return[];let t=[];for(let i=0;i<e.length;i++)t.push(e[i]);return t}static isForIn(e){return/^\w* _in_ \w*$/.test(e)}static isForForIn(e){return/^\w* _in*$/.test(e)}static isForOrForFor(e){return/^\w* _in_ \w|_in*$/.test(e)}static isIgnoreChildren(e){return e.props&&e.props.hasOwnProperty("ignore")}static isNumber(e){if(null==e||""===e)return!1;if("string"==typeof e){return!!(/^\d+$/.test(e)||/^-\d+$/.test(e)||/^[1-9]\d*[.]\d+$/.test(e)||/^0[.]\d+$/.test(e)||/^-[1-9]\d*[.]\d+$/.test(e)||/^-0[.]\d+$/.test(e))}return"number"==typeof e}static setAttr(e,t,i){switch(t){case"style":e.style.cssText=i;break;case"value":let r=e.tagName||"";"input"===(r=r.toLowerCase())||"textarea"===r?e.value=i:e.setAttribute(t,i);break;default:e.setAttribute(t,i)}}static isPlaceHolder(e){return!!e&&!!/^%#\w*.\w*#%$/.test(e)}static isDotOperatorExpression(e){return/^\w*\.\w*$/.test(e)}static getPlaceHolderValue(e){return e.slice(2,-2)}static isOperatorExpression(e){return!!Util.isString(e)&&!!/^\{\w*|\|\%+\}$/.test(e)}static getOperatorExpression(content,data,dataKey){if(Util.isString(content)){var expression=content.slice(content.indexOf("{")+1,content.indexOf("}"));let startIndex=expression.indexOf("%#"),endIndex=expression.indexOf("#%")+2;if(-1!=startIndex&&-1!=endIndex&&startIndex<endIndex){let e=expression.slice(startIndex,endIndex),t;if(e.indexOf(".")>0){if(Util.getPlaceHolderValue(e).split(".")[0]===dataKey){let i=data[Util.getPlaceHolderValue(e).split(".")[1]];t=Util.isNumber(i)?i:`"${i}"`}}else t=data[Util.getPlaceHolderValue(e)];expression=expression.replace(e,t)}return eval(expression)}}}class DiffList{constructor(e,t){let i=this.makeKeyIndex(e).keyIndex,r=this.makeKeyIndex(t).keyIndex;this.moveOperator=[],this.childList=[];for(let i=0;i<e.length;i++){let l=e[i],s=this.getKey(l);r.hasOwnProperty(s)?this.childList.push(t[r[s]]):this.childList.push(null)}this.tempList=this.childList.slice(0);let l=0;for(;l<this.tempList.length;)null===this.tempList[l]?(this.remove(l),this.removeCopyTempList(l)):l++;let s=0;for(let e=0;e<t.length;e++){let r=t[e],l=this.getKey(r),n=this.tempList[s],o=this.getKey(n);if(n)if(l!=o)if(i.hasOwnProperty(l)){l===getKey(this.tempList[s+1])?(this.remove(e),this.removeCopyTempList(s),s++):this.insert(e,r)}else this.insert(e,r);else s++;else this.insert(e,r)}let n=this.tempList.length-s;for(;s++<this.tempList.length;)n--,this.remove(n+t.length)}makeKeyIndex(e){let t={};for(let i=0;i<e.length;i++){let r=e[i];t[this.getKey(r)]=i}return{keyIndex:t}}getKey(e){if(e)return e.key}removeCopyTempList(e){this.tempList.splice(e,1)}remove(e){this.moveOperator.push({index:e,type:0})}insert(e,t){this.moveOperator.push({index:e,item:t,type:1})}getResult(){return{moves:this.moveOperator,child:this.childList}}}function observe(e,t,i){return Object.keys(e).forEach(r=>{let l=e[r],s=new Observable;t.put(r,s),Object.defineProperty(e,r,{get:()=>(s.add(i),l),set(e){const t=l!==e;l=e,t&&s.invoke()}})}),e}function Observable(){this.updateFunctions=new Set}function clone(e){let t,i=e=>null===e?"null":void 0===e?"undefined":Object.prototype.toString.call(e).slice(8,-1),r=i(e);if("Object"===r)t={};else{if("Array"!==r)return e;t=[]}for(key in e){let r=e[key];"Object"==i(r)?t[key]=arguments.callee(r):"Array"==i(r)?t[key]=arguments.callee(r):t[key]=e[key]}return t}function h(e,t,i){return new Element(e,t,i)}function diff(e,t){return new Diff(e,t).patches}function patch(e,t){return new Patch(e,t)}Observable.prototype.add=function(e){this.updateFunctions.add(e)},Observable.prototype.invoke=function(){this.updateFunctions.forEach(e=>e())};class Map{constructor(){this.length=0,this.map=new Object}put(e,t){e in this.map||this.length++,this.map[e]=t}get(e){return e in this.map?this.map[e]:null}remove(e){e in this.map&&(delete this.map[e],this.length--)}size(){return this.length}clear(){length=0,this.map=new Object}}class RV{constructor(e){const{el:t,data:i,dom:r}=e;let l=Util.isString(t)?document.querySelector(t):t;this.data=i,this.ve=this.getVirtualElement(this.applyTruthfulData(r)),this.w=this.ve.render(),l.appendChild(this.w),this.observeMap=new Map,observe(this.data,this.observeMap,()=>{this.updatedom(r)}),this.updatedom(r)}updatedom(e){let t=this.getVirtualElement(this.applyTruthfulData(e));window.nve=t,window.ve=this.ve,patch(this.w,diff(this.ve,t)),this.ve=t}watch(e,t){this.observeMap.get(e).add(t)}getVirtualElement(e){let t=[];for(let i in e.children){let r=e.children[i];if(r instanceof Array)r.forEach(e=>{let i=this.getVirtualElement(e);t.push(i)});else if(r instanceof Object){let e=this.getVirtualElement(r);t.push(e)}else t.push(r)}return h(e.tag,e.props,t)}applyTruthfulData(e){if("for"in e.props){let t,i=[];if(!Util.isForIn)throw new Error("the for directive use error");"childDomDatakey"in e?(i=e.data,t=e.childDomDatakey):"domDataKey"in e?(e.props.for.split(" _in_ ")[1]===e.domDataKey&&(i=e.data),t=e.props.for.split(" _in_ ")[0]):(i=this.data[e.props.for.split(" _in_ ")[1]],t=e.props.for.split(" _in_ ")[0]);let r=[];return i.forEach(i=>{let l=this.vdom2rdom(e,i,t,i);r.push(l)}),r}{let t,i;return"data"in e?(t=e.data,i=e.childDomDatakey):(t=this.data,i=void 0),this.vdom2rdom(e,t,i,this.data)}}vdom2rdom(e,t,i,r){let l={};l.tag=e.tag,l.children=[],l.props={};let s=Object.keys(e.props);for(let n in s){let o=s[n];if("style"===o){let r=e.props[o];if(r.indexOf(",")>-1){let e=r.split(",");l.props[o]=this.handleArrayStyle(t,e,i)}else l.props[o]=this.handleSingleStyle(t,r,i)}else Util.isPlaceHolder(e.props[o])?Util.isDotOperatorExpression(Util.getPlaceHolderValue(e.props[o]))?l.props[o]=t[Util.getPlaceHolderValue(e.props[o]).split(".")[1]]:l.props[o]=r[Util.getPlaceHolderValue(e.props[o])]:Util.isOperatorExpression(e.props[o])?l.props[o]=Util.getOperatorExpression(e.props[o],t,i):l.props[o]=e.props[o]}for(let s in e.children)Util.isString(e.children[s])?Util.isPlaceHolder(e.children[s])?-1==Util.getPlaceHolderValue(e.children[s]).indexOf(i)?l.children[s]=r[Util.getPlaceHolderValue(e.children[s])]:l.children[s]=t[Util.getPlaceHolderValue(e.children[s]).split(".")[1]]:l.children[s]=e.children[s]:(e.children[s]instanceof Object&&("childDomData"in e.props?(e.children[s].childDomDatakey=e.props.childDomData,e.children[s].data=t):"domData"in e.props&&(e.children[s].domDataKey=e.props.domData,e.children[s].data=t[s]),e.children[s].data=t),l.children[s]=this.applyTruthfulData(e.children[s]));return l}handleSingleStyle(e,t,i){let r="";if(i)if(Util.isPlaceHolder(t))if(-1!=Util.getPlaceHolderValue(t).indexOf(i)){r=e[Util.getPlaceHolderValue(t).split(".")[1]]}else{let i=t.split(":")[0],l=t.split(":")[1];r=i+":"+(l=e[Util.getPlaceHolderValue(l)])}else r=t;else{let i=t.split(":")[0],l=t.split(":")[1];r=Util.isPlaceHolder(l)?i+":"+(l=e[Util.getPlaceHolderValue(l)]):t}return r}handleArrayStyle(e,t,i){let r="";for(let l of t){r+=this.handleSingleStyle(e,l,i)+";"}return r}}__webpack_exports__.default=RV}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vZGVtby5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMveWhvbmdtX3J2LmpzL3NyYy9ydi5qcyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIl95aG9uZ21fcnYiLCJydiIsIndpbmRvdyIsImNsaWNrRGl2IiwiZGF0YSIsInBhcmVudCIsIkRhdGUiLCJjbGlja1AxIiwiY2hpbGQiLCJjbGlja1AyIiwiY2hpbGQyIiwib25sb2FkIiwiUlYiLCJlbCIsInBjb2xvciIsImMxY29sb3IiLCJjMmNvbG9yIiwiZG9tIiwidGFnIiwicHJvcHMiLCJzdHlsZSIsIm9uY2xpY2siLCJjaGlsZHJlbiIsIndhdGNoIiwiYWxlcnQiLCJOT0RFX1JFUExBQ0UiLCJDSElMRF9SRV9PUkRFUiIsIk5PREVfUFJPUFMiLCJOT0RFX0NPTlRFTlQiLCJFbGVtZW50IiwiW29iamVjdCBPYmplY3RdIiwidGhpcyIsInRhZ05hbWUiLCJ1bmRlZmluZWQiLCJFcnJvciIsImNvdW50IiwiZm9yRWFjaCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsInByb3BOYW1lIiwiVXRpbCIsInNldEF0dHIiLCJjaGlsZEVsIiwicmVuZGVyIiwiY3JlYXRlVGV4dE5vZGUiLCJhcHBlbmRDaGlsZCIsIkRpZmYiLCJvbGRUcmVlIiwibmV3VHJlZSIsImluZGV4IiwicGF0Y2hlcyIsImRmc1dhbGsiLCJvbGROb2RlIiwibmV3Tm9kZSIsImN1cnJlbnRQYXRjaCIsImlzU3RyaW5nIiwicHVzaCIsInR5cGUiLCJjb250ZW50IiwicHJvcHNQYXRjaGVzIiwiZGlmZlByb3BzIiwiaXNJZ25vcmVDaGlsZHJlbiIsImRpZmZDaGlsZHJlbiIsIm5vZGUiLCJsZW5ndGgiLCJvbGRQcm9wcyIsIm5ld1Byb3BzIiwiaXNTYW1lIiwib2xkQ2hpbGRyZW4iLCJuZXdDaGlsZHJlbiIsImRpZmZzIiwiRGlmZkxpc3QiLCJnZXRSZXN1bHQiLCJtb3ZlcyIsInJlb3JkZXJQYXRjaCIsImxlZnROb2RlIiwiY3VycmVudE5vZGVJbmRleCIsIm5ld0NoaWxkIiwiUGF0Y2giLCJ3YWxrZXIiLCJjdXJyZW50UGF0Y2hlcyIsImxlbiIsImNoaWxkTm9kZXMiLCJhcHBseVBhdGNoZXMiLCJjdXJyZW50UGF0Y2hlIiwicGFyZW50Tm9kZSIsInJlcGxhY2VDaGlsZCIsInJlb3JkZXJDaGlsZHJlbiIsInNldFByb3BzIiwidGV4dENvbnRlbnQiLCJub2RlVmFsdWUiLCJzdGF0aWNOb2RlTGlzdCIsInRvQXJyYXkiLCJub2RlTWFwcyIsInNub2RlIiwibm9kZVR5cGUiLCJnZXRBdHRyaWJ1dGUiLCJtb3ZlIiwicmVtb3ZlQ2hpbGQiLCJzcGxpY2UiLCJpbnNlcnROb2RlIiwiaXRlbSIsImNsb25lTm9kZSIsImluc2VydEJlZm9yZSIsInJlbW92ZUF0dHJpYnV0ZSIsInNvbWUiLCJsaXN0IiwiYXJyYXkiLCJkaXJlY3Rpb24iLCJ0ZXN0IiwiY3NzVGV4dCIsInRvTG93ZXJDYXNlIiwic2V0QXR0cmlidXRlIiwic2xpY2UiLCJkYXRhS2V5IiwiZXhwcmVzc2lvbiIsImluZGV4T2YiLCJzdGFydEluZGV4IiwiZW5kSW5kZXgiLCJwbGFjZUhvbGRlciIsInJlYWxWYWx1ZSIsImdldFBsYWNlSG9sZGVyVmFsdWUiLCJzcGxpdCIsInBsYWNlSG9sZGVyVmFsdWUiLCJpc051bWJlciIsInJlcGxhY2UiLCJldmFsIiwib2xkTGlzdCIsIm5ld0xpc3QiLCJvbGRMaXN0S2V5SW5kZXgiLCJtYWtlS2V5SW5kZXgiLCJrZXlJbmRleCIsIm5ld0xpc3RLZXlJbmRleCIsIm1vdmVPcGVyYXRvciIsImNoaWxkTGlzdCIsIm9sZEl0ZW0iLCJvSXRlbUtleSIsImdldEtleSIsInRlbXBMaXN0IiwicmVtb3ZlIiwicmVtb3ZlQ29weVRlbXBMaXN0Iiwibkl0ZW0iLCJuSXRlbUtleSIsImNJdGVtIiwiY0l0ZW1LZXkiLCJpbnNlcnQiLCJrIiwib2JzZXJ2ZSIsIm9iaiIsIm9ic2VydmVNYXAiLCJjYWxsYmFjayIsImtleXMiLCJpbnRlcm5hbFZhbHVlIiwib2JzZXJ2YWJsZSIsIk9ic2VydmFibGUiLCJwdXQiLCJhZGQiLCJuZXdWYWwiLCJjaGFuZ2VkIiwiaW52b2tlIiwidXBkYXRlRnVuY3Rpb25zIiwiU2V0IiwiY2xvbmUiLCJyZXN1bHQiLCJnZXRUeXBlIiwidG9TdHJpbmciLCJvQ2xhc3MiLCJjb3B5IiwiYXJndW1lbnRzIiwiY2FsbGVlIiwiaCIsImRpZmYiLCJwYXRjaCIsIm9ic2VydmFibGVVcGRhdGUiLCJmdW4iLCJNYXAiLCJtYXAiLCJvcHRpb24iLCJyb290IiwicXVlcnlTZWxlY3RvciIsInZlIiwiZ2V0VmlydHVhbEVsZW1lbnQiLCJhcHBseVRydXRoZnVsRGF0YSIsInciLCJ1cGRhdGVkb20iLCJudmUiLCJjYyIsIkFycmF5IiwidiIsImRhdGFTaW5nbGUiLCJkYXRhQXJyYXkiLCJpc0ZvckluIiwiY2hpbGREb21EYXRha2V5IiwiZG9tRGF0YUtleSIsIm9ianMiLCJ2ZG9tMnJkb20iLCJ0ZGF0YSIsInByb3AiLCJzdHlsZXMiLCJoYW5kbGVBcnJheVN0eWxlIiwiaGFuZGxlU2luZ2xlU3R5bGUiLCJpc1BsYWNlSG9sZGVyIiwiaXNEb3RPcGVyYXRvckV4cHJlc3Npb24iLCJpc09wZXJhdG9yRXhwcmVzc2lvbiIsImdldE9wZXJhdG9yRXhwcmVzc2lvbiIsImNoaWxkRG9tRGF0YSIsImRvbURhdGEiLCJuZXdTdHlsZSIsInN0eWxlS2V5Iiwic3R5bGVWYWx1ZSIsIm5ld1N0eWxlQXJyYXkiLCJfX3dlYnBhY2tfZXhwb3J0c19fIl0sIm1hcHBpbmdzIjoiYUFDQSxJQUFBQSxFQUFBLEdBR0EsU0FBQUMsRUFBQUMsR0FHQSxHQUFBRixFQUFBRSxHQUNBLE9BQUFGLEVBQUFFLEdBQUFDLFFBR0EsSUFBQUMsRUFBQUosRUFBQUUsR0FBQSxDQUNBRyxFQUFBSCxFQUNBSSxHQUFBLEVBQ0FILFFBQUEsSUFVQSxPQU5BSSxFQUFBTCxHQUFBTSxLQUFBSixFQUFBRCxRQUFBQyxJQUFBRCxRQUFBRixHQUdBRyxFQUFBRSxHQUFBLEVBR0FGLEVBQUFELFFBS0FGLEVBQUFRLEVBQUFGLEVBR0FOLEVBQUFTLEVBQUFWLEVBR0FDLEVBQUFVLEVBQUEsU0FBQVIsRUFBQVMsRUFBQUMsR0FDQVosRUFBQWEsRUFBQVgsRUFBQVMsSUFDQUcsT0FBQUMsZUFBQWIsRUFBQVMsRUFBQSxDQUEwQ0ssWUFBQSxFQUFBQyxJQUFBTCxLQUsxQ1osRUFBQWtCLEVBQUEsU0FBQWhCLEdBQ0Esb0JBQUFpQixlQUFBQyxhQUNBTixPQUFBQyxlQUFBYixFQUFBaUIsT0FBQUMsWUFBQSxDQUF3REMsTUFBQSxXQUV4RFAsT0FBQUMsZUFBQWIsRUFBQSxjQUFpRG1CLE9BQUEsS0FRakRyQixFQUFBc0IsRUFBQSxTQUFBRCxFQUFBRSxHQUVBLEdBREEsRUFBQUEsSUFBQUYsRUFBQXJCLEVBQUFxQixJQUNBLEVBQUFFLEVBQUEsT0FBQUYsRUFDQSxLQUFBRSxHQUFBLGlCQUFBRixRQUFBRyxXQUFBLE9BQUFILEVBQ0EsSUFBQUksRUFBQVgsT0FBQVksT0FBQSxNQUdBLEdBRkExQixFQUFBa0IsRUFBQU8sR0FDQVgsT0FBQUMsZUFBQVUsRUFBQSxXQUF5Q1QsWUFBQSxFQUFBSyxVQUN6QyxFQUFBRSxHQUFBLGlCQUFBRixFQUFBLFFBQUFNLEtBQUFOLEVBQUFyQixFQUFBVSxFQUFBZSxFQUFBRSxFQUFBLFNBQUFBLEdBQWdILE9BQUFOLEVBQUFNLElBQXFCQyxLQUFBLEtBQUFELElBQ3JJLE9BQUFGLEdBSUF6QixFQUFBNkIsRUFBQSxTQUFBMUIsR0FDQSxJQUFBUyxFQUFBVCxLQUFBcUIsV0FDQSxXQUEyQixPQUFBckIsRUFBQSxTQUMzQixXQUFpQyxPQUFBQSxHQUVqQyxPQURBSCxFQUFBVSxFQUFBRSxFQUFBLElBQUFBLEdBQ0FBLEdBSUFaLEVBQUFhLEVBQUEsU0FBQWlCLEVBQUFDLEdBQXNELE9BQUFqQixPQUFBa0IsVUFBQUMsZUFBQTFCLEtBQUF1QixFQUFBQyxJQUd0RC9CLEVBQUFrQyxFQUFBLEdBSUFsQyxJQUFBbUMsRUFBQSxrQ0NsRkEsTUFBQUMsRUFBQXBDLEVBQUEsdUNBRUEsSUFBSXFDLFNBQ0pDLE9BQU9DLFNBQVUsV0FDYkYsRUFBR0csS0FBS0MsT0FBUixrQkFBbUMsSUFBSUMsS0FBUyxLQUdwREosT0FBT0ssUUFBUyxXQUNaTixFQUFHRyxLQUFLSSxNQUFSLGlCQUFpQyxJQUFJRixLQUFTLEtBR2xESixPQUFPTyxRQUFTLFdBQ1pSLEVBQUdHLEtBQUtNLE9BQVIsaUJBQWtDLElBQUlKLEtBQVMsS0FFbkRKLE9BQU9TLE9BQVMsWUFFWFYsRUFBSSxJQUFJVyxVQUNMLENBQ0lDLEdBQUksT0FFSlQsS0FBTSxDQUNGQyxPQUFRLFNBQ1JHLE1BQU8sUUFDUE0sT0FBUSxNQUNSQyxRQUFTLE9BQ1RDLFFBQVMsUUFDVE4sT0FBUSxVQUdaTyxJQUFLLENBQ0RDLElBQUssTUFFTEMsTUFBTyxDQUNINUIsSUFBSyxJQUNMNkIsTUFBTyw0Q0FDUEMsUUFBUyxjQUdiQyxTQUFVLENBQUMsYUFFUCxDQUNJSixJQUFLLElBQ0xDLE1BQU8sQ0FDSDVCLElBQUssSUFDTDZCLE1BQU8sMkNBQ1BDLFFBQVMsYUFFYkMsU0FBVSxDQUFDLGNBRWYsQ0FDSUosSUFBSyxJQUNMQyxNQUFPLENBQ0g1QixJQUFLLElBQ0w2QixNQUFPLDJDQUNQQyxRQUFTLGFBRWJDLFNBQVUsQ0FBQyxvQkFPNUJDLE1BQU0sU0FBVSxXQUNmQyxNQUFNLG1CQUVWdkIsRUFBR3NCLE1BQU0sUUFBUyxXQUNkQyxNQUFNLGtCQUVWdkIsRUFBR3NCLE1BQU0sU0FBVSxXQUNmQyxNQUFNLHNJQ3BFZCxNQUFBQyxhQUFBLEVBQ0FDLGVBQUEsRUFDQUMsV0FBQSxFQUNBQyxhQUFBLEVBQ0EsTUFBQUMsUUFPQUMsWUFBQVosRUFBQUMsRUFBQUcsR0FDQSxLQUFBUyxnQkFBQUYsU0FDQSxXQUFBQSxRQUFBRyxRQUFBYixFQUFBRyxHQU1BLEdBSkFTLEtBQUFiLE1BQ0FhLEtBQUFaLFNBQUEsR0FDQVksS0FBQVQsWUFBQSxHQUNBUyxLQUFBeEMsSUFBQTRCLElBQUE1QixTQUFBMEMsR0FDQUYsS0FBQXhDLElBQ0EsVUFBQTJDLFNBQStCaEIsdUNBRS9CLElBQUFpQixFQUFBLEVBQ0FKLEtBQUFULFNBQUFjLFFBQUE1QixJQUNBQSxhQUFBcUIsVUFDQU0sR0FBQTNCLEVBQUEyQixPQUVBQSxNQUVBSixLQUFBSSxRQUtBTCxTQUNBLE1BQUFqQixFQUFBd0IsU0FBQUMsY0FBQVAsS0FBQWIsS0FDQUMsRUFBQVksS0FBQVosTUFDQSxVQUFBb0IsS0FBQXBCLEVBQ0FxQixLQUFBQyxRQUFBNUIsRUFBQTBCLEVBQUFwQixFQUFBb0IsSUFNQSxPQUpBUixLQUFBVCxTQUFBYyxRQUFBNUIsSUFDQSxNQUFBa0MsRUFBQWxDLGFBQUFxQixRQUFBckIsRUFBQW1DLFNBQUFOLFNBQUFPLGVBQUFwQyxHQUNBSyxFQUFBZ0MsWUFBQUgsS0FFQTdCLEdBSUEsTUFBQWlDLEtBTUFoQixZQUFBaUIsRUFBQUMsR0FDQWpCLEtBQUFrQixNQUFBLEVBQ0FsQixLQUFBbUIsUUFBQSxHQUNBbkIsS0FBQW9CLFFBQUFKLEVBQUFDLEVBQUFqQixLQUFBa0IsT0FFQW5CLFFBQUFzQixFQUFBQyxFQUFBSixHQUNBLElBQUFLLEVBQUEsR0FDQSxTQUFBRCxRQUVTLEdBQUFiLEtBQUFlLFNBQUFILElBQUFaLEtBQUFlLFNBQUFGLEdBQ1RELEdBQUFDLEdBQ0FDLEVBQUFFLEtBQUEsQ0FDQUMsS0FBQTdCLGFBQ0E4QixRQUFBTCxTQUdTLEdBQUFELEVBQUFwQixVQUFBcUIsRUFBQXJCLFNBQUFvQixFQUFBN0QsS0FBQThELEVBQUE5RCxJQUFBLENBQ1QsSUFBQW9FLEVBQUE1QixLQUFBNkIsVUFBQVIsRUFBQUMsR0FDQU0sR0FDQUwsRUFBQUUsS0FBQSxDQUNBQyxLQUFBOUIsV0FDQVIsTUFBQXdDLElBR0FuQixLQUFBcUIsaUJBQUFSLElBQ0F0QixLQUFBK0IsYUFBQVYsRUFBQTlCLFNBQUErQixFQUFBL0IsU0FBQTJCLEVBQUFLLFFBR0FBLEVBQUFFLEtBQUEsQ0FDQUMsS0FBQWhDLGFBQ0FzQyxLQUFBVixJQUdBQyxFQUFBVSxTQUNBakMsS0FBQW1CLFFBQUFELEdBQUFLLEdBR0F4QixVQUFBc0IsRUFBQUMsR0FFQSxNQUFBWSxFQUFBYixFQUFBakMsTUFDQStDLEVBQUFiLEVBQUFsQyxNQUVBd0MsRUFBQSxHQUNBLElBQUFRLEdBQUEsRUFDQSxRQUFBNUUsS0FBQTBFLEVBQ0FDLEVBQUEzRSxLQUFBMEUsRUFBQTFFLEtBQ0E0RSxHQUFBLEVBQ0FSLEVBQUFwRSxHQUFBMkUsRUFBQTNFLElBR0EsUUFBQUEsS0FBQTJFLEVBQ0FELEVBQUFwRSxlQUFBTixLQUNBNEUsR0FBQSxFQUNBUixFQUFBcEUsR0FBQTJFLEVBQUEzRSxJQUdBLE9BQUE0RSxFQUFBLEtBQUFSLEVBR0E3QixhQUFBc0MsRUFBQUMsRUFBQXBCLEVBQUFLLEdBQ0EsSUFDQWdCLEVBREEsSUFBQUMsU0FBQUgsRUFBQUMsR0FDQUcsWUFFQSxHQURBSCxFQUFBQyxFQUFBOUQsTUFDQThELEVBQUFHLE1BQUFULE9BQUEsQ0FDQSxJQUFBVSxFQUFBLENBQ0FqQixLQUFBL0IsZUFDQStDLE1BQUFILEVBQUFHLE9BRUFuQixFQUFBRSxLQUFBa0IsR0FFQSxJQUFBQyxFQUFBLEtBQ0FDLEVBQUEzQixFQUNBbUIsRUFBQWhDLFFBQUEsQ0FBQTVCLEVBQUF4QyxLQUNBLElBQUE2RyxFQUFBUixFQUFBckcsR0FDQTRHLEVBQUFELEtBQUF4QyxNQUNBeUMsRUFBQUQsRUFBQXhDLE1BQUEsRUFDQXlDLEVBQUEsRUFDQTdDLEtBQUFvQixRQUFBM0MsRUFBQXFFLEVBQUFELEdBQ0FELEVBQUFuRSxLQU9BLE1BQUFzRSxNQUNBaEQsWUFBQWlDLEVBQUFiLEdBSUFuQixLQUFBb0IsUUFBQVksRUFIQSxDQUNBZCxNQUFBLEdBRUFDLEdBRUFwQixRQUFBaUMsRUFBQWdCLEVBQUE3QixHQUNBLElBQUE4QixFQUFBOUIsRUFBQTZCLEVBQUE5QixPQUNBZ0MsRUFBQWxCLEVBQUFtQixXQUFBbkIsRUFBQW1CLFdBQUFsQixPQUFBLEVBQ0EsUUFBQWhHLEVBQUEsRUFBdUJBLEVBQUFpSCxFQUFTakgsSUFBQSxDQUNoQyxJQUFBd0MsRUFBQXVELEVBQUFtQixXQUFBbEgsR0FDQStHLEVBQUE5QixRQUNBbEIsS0FBQW9CLFFBQUEzQyxFQUFBdUUsRUFBQTdCLEdBRUE4QixHQUNBakQsS0FBQW9ELGFBQUFwQixFQUFBaUIsR0FJQWxELGFBQUFpQyxFQUFBcUIsR0FDQUEsRUFBQWhELFFBQUFrQixJQUNBLE9BQUFBLEVBQUFHLE1BQ0EsS0FBQWhDLGFBQ0EsSUFBQTRCLEVBQUFiLEtBQUFlLFNBQUFELEVBQUFTLE1BQUExQixTQUFBTyxlQUFBVSxFQUFBUyxNQUFBVCxFQUFBUyxLQUFBcEIsU0FDQW9CLEVBQUFzQixXQUFBQyxhQUFBakMsRUFBQVUsR0FDQSxNQUNBLEtBQUFyQyxlQUNBSyxLQUFBd0QsZ0JBQUF4QixFQUFBVCxFQUFBbUIsT0FDQSxNQUNBLEtBQUE5QyxXQUNBSSxLQUFBeUQsU0FBQXpCLEVBQUFULEVBQUFuQyxPQUNBLE1BQ0EsS0FBQVMsYUFDQW1DLEVBQUEwQixZQUNBMUIsRUFBQTBCLFlBQUFuQyxFQUFBSSxRQUVBSyxFQUFBMkIsVUFBQXBDLEVBQUFJLFdBU0E1QixnQkFBQWlDLEVBQUFVLEdBQ0EsSUFBQWtCLEVBQUFuRCxLQUFBb0QsUUFBQTdCLEVBQUFtQixZQUNBVyxFQUFBLEdBQ0FGLEVBQUF2RCxRQUFBMEQsSUFDQSxPQUFBQSxFQUFBQyxTQUFBLENBQ0EsSUFBQXhHLEVBQUF1RyxFQUFBRSxhQUFBLE9BQ0F6RyxJQUNBc0csRUFBQXRHLEdBQUF1RyxNQUlBckIsRUFBQXJDLFFBQUE2RCxJQUNBLElBQUFoRCxFQUFBZ0QsRUFBQWhELE1BQ0EsT0FBQWdELEVBQUF4QyxLQUNBa0MsRUFBQTFDLEtBQUFjLEVBQUFtQixXQUFBakMsSUFDQWMsRUFBQW1DLFlBQUFuQyxFQUFBbUIsV0FBQWpDLElBRUEwQyxFQUFBUSxPQUFBbEQsRUFBQSxRQUNhLE9BQUFnRCxFQUFBeEMsS0FBQSxDQUNiLElBQUEyQyxFQUFBUCxFQUFBSSxFQUFBSSxLQUFBOUcsS0FDQXNHLEVBQUFJLEVBQUFJLEtBQUE5RyxLQUFBK0csV0FBQSxHQUNBOUQsS0FBQWUsU0FBQTBDLEVBQUFJLE1BQUFoRSxTQUFBTyxlQUFBcUQsRUFBQUksTUFBQUosRUFBQUksS0FBQTFELFNBQ0FnRCxFQUFBUSxPQUFBbEQsRUFBQSxFQUFBbUQsR0FDQXJDLEVBQUF3QyxhQUFBSCxFQUFBckMsRUFBQW1CLFdBQUFqQyxJQUFBLFNBS0FuQixTQUFBaUMsRUFBQTVDLEdBQ0EsUUFBQTVCLEtBQUE0QixFQUNBLFFBQUFjLElBQUFkLEVBQUE1QixHQUNBd0UsRUFBQXlDLGdCQUFBakgsT0FDYSxDQUNiLE1BQUFOLEVBQUFrQyxFQUFBNUIsR0FDQWlELEtBQUFDLFFBQUFzQixFQUFBeEUsRUFBQU4sS0FVQSxNQUFBdUQsS0FDQVYsZ0JBQUEyRSxHQUNBLHVCQUFBQSxFQUVBM0UsZUFBQTRFLEdBQ0EsSUFBQUEsRUFDQSxTQUVBLElBQUFDLEVBQUEsR0FDQSxRQUFBM0ksRUFBQSxFQUF1QkEsRUFBQTBJLEVBQUExQyxPQUFpQmhHLElBQ3hDMkksRUFBQW5ELEtBQUFrRCxFQUFBMUksSUFFQSxPQUFBMkksRUFFQTdFLGVBQUE4RSxHQUNBLHVCQUFBQyxLQUFBRCxHQUVBOUUsa0JBQUE4RSxHQUNBLG1CQUFBQyxLQUFBRCxHQUdBOUUscUJBQUE4RSxHQUNBLDJCQUFBQyxLQUFBRCxHQUVBOUUsd0JBQUFpQyxHQUNBLE9BQUFBLEVBQUE1QyxPQUFBNEMsRUFBQTVDLE1BQUF0QixlQUFBLFVBRUFpQyxnQkFBQTdDLEdBQ0EsR0FBQUEsU0FBQSxLQUFBQSxFQUNBLFNBR0EsdUJBWUEsU0FWQSxRQVVBNEgsS0FBQTVILElBUkEsU0FRQTRILEtBQUE1SCxJQU5BLG1CQU9BNEgsS0FBQTVILElBTkEsWUFNQTRILEtBQUE1SCxJQUpBLG9CQUtBNEgsS0FBQTVILElBSkEsYUFJQTRILEtBQUE1SCxJQU9BLHlCQVNBNkMsZUFBQWlDLEVBQUF4RSxFQUFBTixHQUNBLE9BQUFNLEdBQ0EsWUFDQXdFLEVBQUEzQyxNQUFBMEYsUUFBQTdILEVBQ0EsTUFDQSxZQUNBLElBQUErQyxFQUFBK0IsRUFBQS9CLFNBQUEsR0FFQSxXQURBQSxJQUFBK0UsZ0JBQ0EsYUFBQS9FLEVBQ0ErQixFQUFBOUUsUUFFQThFLEVBQUFpRCxhQUFBekgsRUFBQU4sR0FFQSxNQUNBLFFBQ0E4RSxFQUFBaUQsYUFBQXpILEVBQUFOLElBS0E2QyxxQkFBQTRCLEdBQ0EsUUFBQUEsS0FDQSxnQkFBQW1ELEtBQUFuRCxHQVNBNUIsK0JBQUE0QixHQUNBLG1CQUFBbUQsS0FBQW5ELEdBRUE1QiwyQkFBQTRCLEdBQ0EsT0FBQUEsRUFBQXVELE1BQUEsTUFNQW5GLDRCQUFBNEIsR0FFQSxRQUFBbEIsS0FBQWUsU0FBQUcsTUFDQSxrQkFBK0JtRCxLQUFBbkQsR0FVL0I1Qiw2QkFBQTRCLFFBQUF0RCxLQUFBOEcsU0FDQSxHQUFBMUUsS0FBQWUsU0FBQUcsU0FBQSxDQUVBLElBQUF5RCxXQUFBekQsUUFBQXVELE1BQUF2RCxRQUFBMEQsUUFBQSxLQUE2RCxFQUFBMUQsUUFBQTBELFFBQUEsTUFDN0QsSUFBQUMsV0FBQUYsV0FBQUMsUUFBQSxNQUNBRSxTQUFBSCxXQUFBQyxRQUFBLFFBQ0EsT0FBQUMsYUFBQSxHQUFBQyxVQUFBRCxXQUFBQyxTQUFBLENBQ0EsSUFBQUMsRUFBQUosV0FBQUYsTUFBQUksV0FBQUMsVUFDQUUsRUFDQSxHQUFBRCxFQUFBSCxRQUFBLFFBQ0EsR0FBQTVFLEtBQUFpRixvQkFBQUYsR0FBQUcsTUFBQSxVQUFBUixRQUFBLENBQ0EsSUFBQVMsRUFBQXZILEtBQUFvQyxLQUFBaUYsb0JBQUFGLEdBQUFHLE1BQUEsU0FDQUYsRUFBQWhGLEtBQUFvRixTQUFBRCxTQUE2RkEsV0FNN0ZILEVBQUFwSCxLQUFBb0MsS0FBQWlGLG9CQUFBRixJQUdBSixzQkFBQVUsUUFBQU4sRUFBQUMsR0FHQSxPQUFBTSxLQUFBWCxjQVFBLE1BQUE1QyxTQU9BekMsWUFBQWlHLEVBQUFDLEdBQ0EsSUFBQUMsRUFBQWxHLEtBQUFtRyxhQUFBSCxHQUFBSSxTQUNBQyxFQUFBckcsS0FBQW1HLGFBQUFGLEdBQUFHLFNBQ0FwRyxLQUFBc0csYUFBQSxHQUNBdEcsS0FBQXVHLFVBQUEsR0FDQSxRQUFBdEssRUFBQSxFQUF1QkEsRUFBQStKLEVBQUEvRCxPQUFvQmhHLElBQUEsQ0FDM0MsSUFBQXVLLEVBQUFSLEVBQUEvSixHQUNBd0ssRUFBQXpHLEtBQUEwRyxPQUFBRixHQUNBSCxFQUFBdkksZUFBQTJJLEdBR0F6RyxLQUFBdUcsVUFBQTlFLEtBQUF3RSxFQUFBSSxFQUFBSSxLQUZBekcsS0FBQXVHLFVBQUE5RSxLQUFBLE1BS0F6QixLQUFBMkcsU0FBQTNHLEtBQUF1RyxVQUFBckIsTUFBQSxHQUNBLElBQUFqSixFQUFBLEVBQ0EsS0FBQUEsRUFBQStELEtBQUEyRyxTQUFBMUUsUUFDQSxPQUFBakMsS0FBQTJHLFNBQUExSyxJQUNBK0QsS0FBQTRHLE9BQUEzSyxHQUNBK0QsS0FBQTZHLG1CQUFBNUssSUFFQUEsSUFHQSxJQUFBaUYsRUFBQSxFQUNBLFFBQUFqRixFQUFBLEVBQXVCQSxFQUFBZ0ssRUFBQWhFLE9BQW9CaEcsSUFBQSxDQUMzQyxJQUFBNkssRUFBQWIsRUFBQWhLLEdBQ0E4SyxFQUFBL0csS0FBQTBHLE9BQUFJLEdBQ0FFLEVBQUFoSCxLQUFBMkcsU0FBQXpGLEdBQ0ErRixFQUFBakgsS0FBQTBHLE9BQUFNLEdBQ0EsR0FBQUEsRUFDQSxHQUFBRCxHQUFBRSxFQUNBLEdBQUFmLEVBQUFwSSxlQUFBaUosR0FBQSxDQUVBQSxJQURBTCxPQUFBMUcsS0FBQTJHLFNBQUF6RixFQUFBLEtBRUFsQixLQUFBNEcsT0FBQTNLLEdBQ0ErRCxLQUFBNkcsbUJBQUEzRixHQUNBQSxLQUVBbEIsS0FBQWtILE9BQUFqTCxFQUFBNkssUUFHQTlHLEtBQUFrSCxPQUFBakwsRUFBQTZLLFFBR0E1RixTQUdBbEIsS0FBQWtILE9BQUFqTCxFQUFBNkssR0FHQSxJQUFBSyxFQUFBbkgsS0FBQTJHLFNBQUExRSxPQUFBZixFQUNBLEtBQUFBLElBQUFsQixLQUFBMkcsU0FBQTFFLFFBQ0FrRixJQUNBbkgsS0FBQTRHLE9BQUFPLEVBQUFsQixFQUFBaEUsUUFLQWxDLGFBQUE0RSxHQUNBLElBQUF5QixFQUFBLEdBQ0EsUUFBQW5LLEVBQUEsRUFBdUJBLEVBQUEwSSxFQUFBMUMsT0FBaUJoRyxJQUFBLENBQ3hDLElBQUFxSSxFQUFBSyxFQUFBMUksR0FFQW1LLEVBREFwRyxLQUFBMEcsT0FBQXBDLElBQ0FySSxFQUVBLE9BQ0FtSyxZQUlBckcsT0FBQXVFLEdBQ0EsR0FBQUEsRUFHQSxPQUFBQSxFQUFBLElBRUF2RSxtQkFBQW1CLEdBQ0FsQixLQUFBMkcsU0FBQXZDLE9BQUFsRCxFQUFBLEdBRUFuQixPQUFBbUIsR0FDQWxCLEtBQUFzRyxhQUFBN0UsS0FBQSxDQUNBUCxRQUNBUSxLQUFBLElBSUEzQixPQUFBbUIsRUFBQW9ELEdBQ0F0RSxLQUFBc0csYUFBQTdFLEtBQUEsQ0FDQVAsUUFDQW9ELE9BQ0E1QyxLQUFBLElBSUEzQixZQUNBLE9BQ0EyQyxNQUFBMUMsS0FBQXNHLGFBQ0E3SCxNQUFBdUIsS0FBQXVHLFlBT0EsU0FBQWEsUUFBQUMsRUFBQUMsRUFBQUMsR0FvQkEsT0FsQkE1SyxPQUFBNkssS0FBQUgsR0FBQWhILFFBQUE3QyxJQUNBLElBQUFpSyxFQUFBSixFQUFBN0osR0FDQWtLLEVBQUEsSUFBQUMsV0FDQUwsRUFBQU0sSUFBQXBLLEVBQUFrSyxHQUNBL0ssT0FBQUMsZUFBQXlLLEVBQUE3SixFQUFBLENBQ0FWLElBQUEsS0FDQTRLLEVBQUFHLElBQUFOLEdBQ0FFLEdBRUExSCxJQUFBK0gsR0FDQSxNQUFBQyxFQUFBTixJQUFBSyxFQUNBTCxFQUFBSyxFQUNBQyxHQUNBTCxFQUFBTSxjQUtBWCxFQUtBLFNBQUFNLGFBQ0EzSCxLQUFBaUksZ0JBQUEsSUFBQUMsSUFjQSxTQUFBQyxNQUFBZCxHQUNBLElBS0FlLEVBTEFDLEVBQUEzTCxHQUNBLE9BQUFBLEVBQUEsWUFDQXdELElBQUF4RCxFQUFBLFlBQ0FDLE9BQUFrQixVQUFBeUssU0FBQWxNLEtBQUFNLEdBQUF3SSxNQUFBLE1BRUFxRCxFQUFBRixFQUFBaEIsR0FDQSxjQUFBa0IsRUFDQUgsRUFBQSxPQUNLLGNBQUFHLEVBR0wsT0FBQWxCLEVBRkFlLEVBQUEsR0FJQSxJQUFBNUssT0FBQTZKLEVBQUEsQ0FDQSxJQUFBbUIsRUFBQW5CLEVBQUE3SixLQUNBLFVBQUE2SyxFQUFBRyxHQUNBSixFQUFBNUssS0FBQWlMLFVBQUFDLE9BQUFGLEdBQ1MsU0FBQUgsRUFBQUcsR0FDVEosRUFBQTVLLEtBQUFpTCxVQUFBQyxPQUFBRixHQUVBSixFQUFBNUssS0FBQTZKLEVBQUE3SixLQUdBLE9BQUE0SyxFQUlBLFNBQUFPLEVBQUExSSxFQUFBYixFQUFBRyxHQUNBLFdBQUFPLFFBQUFHLEVBQUFiLEVBQUFHLEdBR0EsU0FBQXFKLEtBQUE1SCxFQUFBQyxHQUVBLE9BREEsSUFBQUYsS0FBQUMsRUFBQUMsR0FDQUUsUUFJQSxTQUFBMEgsTUFBQTdHLEVBQUFiLEdBQ0EsV0FBQTRCLE1BQUFmLEVBQUFiLEdBbkRBd0csV0FBQTlKLFVBQUFnSyxJQUFBLFNBQUFpQixHQUNBOUksS0FBQWlJLGdCQUFBSixJQUFBaUIsSUFFQW5CLFdBQUE5SixVQUFBbUssT0FBQSxXQUNBaEksS0FBQWlJLGdCQUFBNUgsUUFBQTBJLFNBb0RBLE1BQUFDLElBQ0FqSixjQUNBQyxLQUFBaUMsT0FBQSxFQUNBakMsS0FBQWlKLElBQUEsSUFBQXRNLE9BRUFvRCxJQUFBdkMsRUFBQU4sR0FDQU0sS0FBQXdDLEtBQUFpSixLQUNBakosS0FBQWlDLFNBRUFqQyxLQUFBaUosSUFBQXpMLEdBQUFOLEVBRUE2QyxJQUFBdkMsR0FDQSxPQUFBQSxLQUFBd0MsS0FBQWlKLElBQUFqSixLQUFBaUosSUFBQXpMLEdBQUEsS0FFQXVDLE9BQUF2QyxHQUNBQSxLQUFBd0MsS0FBQWlKLGFBQ0FqSixLQUFBaUosSUFBQXpMLEdBQ0F3QyxLQUFBaUMsVUFHQWxDLE9BQ0EsT0FBQUMsS0FBQWlDLE9BRUFsQyxRQUNBa0MsT0FBQSxFQUNBakMsS0FBQWlKLElBQUEsSUFBQXRNLFFBS0EsTUFBQWtDLEdBQ0FrQixZQUFBbUosR0FDQSxNQUFBcEssR0FDQUEsRUFBQVQsS0FDQUEsRUFBQWEsSUFDQUEsR0FDU2dLLEVBQ1QsSUFBQUMsRUFBQTFJLEtBQUFlLFNBQUExQyxHQUFBd0IsU0FBQThJLGNBQUF0SyxLQUNBa0IsS0FBQTNCLE9BQ0EyQixLQUFBcUosR0FBQXJKLEtBQUFzSixrQkFBQXRKLEtBQUF1SixrQkFBQXJLLElBQ0FjLEtBQUF3SixFQUFBeEosS0FBQXFKLEdBQUF6SSxTQUNBdUksRUFBQXJJLFlBQUFkLEtBQUF3SixHQUNBeEosS0FBQXNILFdBQUEsSUFBQTBCLElBQ0E1QixRQUFBcEgsS0FBQTNCLEtBQUEyQixLQUFBc0gsV0FBQSxLQUNBdEgsS0FBQXlKLFVBQUF2SyxLQUVBYyxLQUFBeUosVUFBQXZLLEdBR0FhLFVBQUFiLEdBQ0EsSUFBQXdLLEVBQUExSixLQUFBc0osa0JBQUF0SixLQUFBdUosa0JBQUFySyxJQUNBZixPQUFBdUwsTUFDQXZMLE9BQUFrTCxHQUFBckosS0FBQXFKLEdBQ0FSLE1BQUE3SSxLQUFBd0osRUFBQVosS0FBQTVJLEtBQUFxSixHQUFBSyxJQUNBMUosS0FBQXFKLEdBQUFLLEVBRUEzSixNQUFBdkMsRUFBQStKLEdBQ0F2SCxLQUFBc0gsV0FBQXhLLElBQUFVLEdBQUFxSyxJQUFBTixHQUVBeEgsa0JBQUFiLEdBQ0EsSUFBQUssRUFBQSxHQUNBLFFBQUFkLEtBQUFTLEVBQUFLLFNBQUEsQ0FDQSxJQUFBb0ssRUFBQXpLLEVBQUFLLFNBQUFkLEdBQ0EsR0FBQWtMLGFBQUFDLE1BQ0FELEVBQUF0SixRQUFBL0QsSUFDQSxJQUFBdU4sRUFBQTdKLEtBQUFzSixrQkFBQWhOLEdBQ0FpRCxFQUFBa0MsS0FBQW9JLFVBRWEsR0FBQUYsYUFBQWhOLE9BQUEsQ0FDYixJQUFBa04sRUFBQTdKLEtBQUFzSixrQkFBQUssR0FDQXBLLEVBQUFrQyxLQUFBb0ksUUFFQXRLLEVBQUFrQyxLQUFBa0ksR0FJQSxPQUFBaEIsRUFBQXpKLEVBQUFDLElBQUFELEVBQUFFLE1BQUFHLEdBRUFRLGtCQUFBYixHQUNBLFdBQUFBLEVBQUFFLE1BQUEsQ0FDQSxJQUNBMEssRUFEQUMsRUFBQSxHQUdBLElBQUF0SixLQUFBdUosUUFpQkEsVUFBQTdKLE1BQUEsK0JBaEJBLG9CQUFBakIsR0FDQTZLLEVBQUE3SyxFQUFBYixLQUNBeUwsRUFBQTVLLEVBQUErSyxpQkFDaUIsZUFBQS9LLEdBQ2pCQSxFQUFBRSxNQUFBLElBQUF1RyxNQUFBLGVBQUF6RyxFQUFBZ0wsYUFDQUgsRUFBQTdLLEVBQUFiLE1BRUF5TCxFQUFBNUssRUFBQUUsTUFBQSxJQUFBdUcsTUFBQSxlQUlBb0UsRUFBQS9KLEtBQUEzQixLQUFBYSxFQUFBRSxNQUFBLElBQUF1RyxNQUFBLGNBQ0FtRSxFQUFBNUssRUFBQUUsTUFBQSxJQUFBdUcsTUFBQSxjQU1BLElBQUF3RSxFQUFBLEdBU0EsT0FSQUosRUFBQTFKLFFBQUFoQyxJQUVBLElBQUFnSixFQUFBckgsS0FBQW9LLFVBQUFsTCxFQUFBYixFQUFBeUwsRUFBQXpMLEdBRUE4TCxFQUFBMUksS0FBQTRGLEtBSUE4QyxFQUNTLENBRVQsSUFBQTlMLEVBQ0E0TCxFQVdBLE1BVkEsU0FBQS9LLEdBQ0FiLEVBQUFhLEVBQUFiLEtBQ0E0TCxFQUFBL0ssRUFBQStLLGtCQUVBNUwsRUFBQTJCLEtBQUEzQixLQUNBNEwsT0FBQS9KLEdBR0FGLEtBQUFvSyxVQUFBbEwsRUFBQWIsRUFBQTRMLEVBQUFqSyxLQUFBM0IsT0FZQTBCLFVBQUFiLEVBQUFiLEVBQUF5TCxFQUFBTyxHQUNBLElBQUFoRCxFQUFBLEdBQ0FBLEVBQUFsSSxJQUFBRCxFQUFBQyxJQUNBa0ksRUFBQTlILFNBQUEsR0FDQThILEVBQUFqSSxNQUFBLEdBQ0EsSUFBQUEsRUFBQXpDLE9BQUE2SyxLQUFBdEksRUFBQUUsT0FDQSxRQUFBa0wsS0FBQWxMLEVBQUEsQ0FDQSxJQUFBbEMsRUFBQWtDLEVBQUFrTCxHQUNBLGFBQUFwTixFQUFBLENBQ0EsSUFBQW1DLEVBQUFILEVBQUFFLE1BQUFsQyxHQUVBLEdBQUFtQyxFQUFBZ0csUUFBQSxTQUNBLElBQUFrRixFQUFBbEwsRUFBQXNHLE1BQUEsS0FDQTBCLEVBQUFqSSxNQUFBbEMsR0FBQThDLEtBQUF3SyxpQkFBQW5NLEVBQUFrTSxFQUFBVCxRQUdBekMsRUFBQWpJLE1BQUFsQyxHQUFBOEMsS0FBQXlLLGtCQUFBcE0sRUFBQWdCLEVBQUF5SyxRQUlBckosS0FBQWlLLGNBQUF4TCxFQUFBRSxNQUFBbEMsSUFDQXVELEtBQUFrSyx3QkFBQWxLLEtBQUFpRixvQkFBQXhHLEVBQUFFLE1BQUFsQyxLQUdBbUssRUFBQWpJLE1BQUFsQyxHQUFBbUIsRUFBQW9DLEtBQUFpRixvQkFBQXhHLEVBQUFFLE1BQUFsQyxJQUFBeUksTUFBQSxTQUZBMEIsRUFBQWpJLE1BQUFsQyxHQUFBbU4sRUFBQTVKLEtBQUFpRixvQkFBQXhHLEVBQUFFLE1BQUFsQyxLQUlpQnVELEtBQUFtSyxxQkFBQTFMLEVBQUFFLE1BQUFsQyxJQUVqQm1LLEVBQUFqSSxNQUFBbEMsR0FBQXVELEtBQUFvSyxzQkFBQTNMLEVBQUFFLE1BQUFsQyxHQUFBbUIsRUFBQXlMLEdBR0F6QyxFQUFBakksTUFBQWxDLEdBQUFnQyxFQUFBRSxNQUFBbEMsR0FPQSxRQUFBdUIsS0FBQVMsRUFBQUssU0FDQWtCLEtBQUFlLFNBQUF0QyxFQUFBSyxTQUFBZCxJQUNBZ0MsS0FBQWlLLGNBQUF4TCxFQUFBSyxTQUFBZCxLQUNBLEdBQUFnQyxLQUFBaUYsb0JBQUF4RyxFQUFBSyxTQUFBZCxJQUFBNEcsUUFBQXlFLEdBQ0F6QyxFQUFBOUgsU0FBQWQsR0FBQTRMLEVBQUE1SixLQUFBaUYsb0JBQUF4RyxFQUFBSyxTQUFBZCxLQUdBNEksRUFBQTlILFNBQUFkLEdBQUFKLEVBQUFvQyxLQUFBaUYsb0JBQUF4RyxFQUFBSyxTQUFBZCxJQUFBa0gsTUFBQSxTQUtBMEIsRUFBQTlILFNBQUFkLEdBQUFTLEVBQUFLLFNBQUFkLElBSUFTLEVBQUFLLFNBQUFkLGFBQUE5QixTQUNBLGlCQUFBdUMsRUFBQUUsT0FDQUYsRUFBQUssU0FBQWQsR0FBQXdMLGdCQUFBL0ssRUFBQUUsTUFBQTBMLGFBRUE1TCxFQUFBSyxTQUFBZCxHQUFBSixRQUNxQixZQUFBYSxFQUFBRSxRQUNyQkYsRUFBQUssU0FBQWQsR0FBQXlMLFdBQUFoTCxFQUFBRSxNQUFBMkwsUUFDQTdMLEVBQUFLLFNBQUFkLEdBQUFKLE9BQUFJLElBR0FTLEVBQUFLLFNBQUFkLEdBQUFKLFFBSUFnSixFQUFBOUgsU0FBQWQsR0FBQXVCLEtBQUF1SixrQkFBQXJLLEVBQUFLLFNBQUFkLEtBSUEsT0FBQTRJLEVBR0F0SCxrQkFBQTFCLEVBQUFnQixFQUFBeUssR0FDQSxJQUFBa0IsRUFBQSxHQUNBLEdBQUFsQixFQUNBLEdBQUFySixLQUFBaUssY0FBQXJMLEdBQ0EsT0FBQW9CLEtBQUFpRixvQkFBQXJHLEdBQUFnRyxRQUFBeUUsR0FBQSxDQUVBa0IsRUFBQTNNLEVBREFvQyxLQUFBaUYsb0JBQUFyRyxHQUFBc0csTUFBQSxhQUVpQixDQUNqQixJQUFBc0YsRUFBQTVMLEVBQUFzRyxNQUFBLFFBQ0F1RixFQUFBN0wsRUFBQXNHLE1BQUEsUUFFQXFGLEVBQUFDLEVBQUEsS0FEQUMsRUFBQTdNLEVBQUFvQyxLQUFBaUYsb0JBQUF3RixVQUlBRixFQUFBM0wsTUFFUyxDQUVULElBQUE0TCxFQUFBNUwsRUFBQXNHLE1BQUEsUUFDQXVGLEVBQUE3TCxFQUFBc0csTUFBQSxRQUlBcUYsRUFIQXZLLEtBQUFpSyxjQUFBUSxHQUdBRCxFQUFBLEtBREFDLEVBQUE3TSxFQUFBb0MsS0FBQWlGLG9CQUFBd0YsS0FJQTdMLEVBSUEsT0FBQTJMLEVBRUFqTCxpQkFBQTFCLEVBQUFrTSxFQUFBVCxHQUNBLElBQUFxQixFQUFBLEdBQ0EsUUFBQTlMLEtBQUFrTCxFQUFBLENBR0FZLEdBREFuTCxLQUFBeUssa0JBQUFwTSxFQUFBZ0IsRUFBQXlLLEdBQ0EsSUFFQSxPQUFBcUIsR0FPZUMsb0JBQUEiLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiaW1wb3J0IFJWIGZyb20gJ3lob25nbV9ydi5qcydcclxuXHJcbmxldCBydlxyXG53aW5kb3cuY2xpY2tEaXY9IGZ1bmN0aW9uICgpIHtcclxuICAgIHJ2LmRhdGEucGFyZW50ID0gYGNsaWNrIERpdiB0aW1lOiR7bmV3IERhdGUoKSAvIDEwMDB9YCAvL2RhdGHlj5jljJbvvIzop4blm77oh6rliqjmm7TmlrBcclxufVxyXG5cclxud2luZG93LmNsaWNrUDE9IGZ1bmN0aW9uICgpIHtcclxuICAgIHJ2LmRhdGEuY2hpbGQgPSBgY2xpY2sgcDEgdGltZToke25ldyBEYXRlKCkgLyAxMDAwfWAgLy9kYXRh5Y+Y5YyWLOinhuWbvuiHquWKqOabtOaWsFxyXG59XHJcblxyXG53aW5kb3cuY2xpY2tQMj0gZnVuY3Rpb24gKCkge1xyXG4gICAgcnYuZGF0YS5jaGlsZDIgPSBgY2xpY2sgcDIgdGltZToke25ldyBEYXRlKCkgLyAxMDAwfWAgLy9kYXRh5Y+Y5YyWLOinhuWbvuiHquWKqOabtOaWsFxyXG59XHJcbndpbmRvdy5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBcclxuICAgICBydj0gbmV3IFJWKCAvL+WIm+W7uuWvueixoVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZWw6IFwiI2FwcFwiLFxyXG4gICAgICAgICAgICAvL2Vs5a+56LGh5oyC6L2955qE6IqC54K5c1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBwYXJlbnQ6IFwicGFyZW50XCIsXHJcbiAgICAgICAgICAgICAgICBjaGlsZDogXCJjaGlsZFwiLFxyXG4gICAgICAgICAgICAgICAgcGNvbG9yOiBcInJlZFwiLFxyXG4gICAgICAgICAgICAgICAgYzFjb2xvcjogXCJibHVlXCIsXHJcbiAgICAgICAgICAgICAgICBjMmNvbG9yOiBcImdyZWVuXCIsXHJcbiAgICAgICAgICAgICAgICBjaGlsZDI6IFwiY2hpbGQyXCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgLy9kYXRh5Li66Jma5oufZG9t57uR5a6a55qE5pWw5o2u5a+56LGh77yM6Jma5oufZG9t5Y+W55So5pWw5o2u5pe25L2/55SoJSMjJeWNoOS9jeespuWPlueUqOWvueW6lOaVsOaNrlxyXG4gICAgICAgICAgICBkb206IHtcclxuICAgICAgICAgICAgICAgIHRhZzogXCJkaXZcIixcclxuICAgICAgICAgICAgICAgIC8vdGFn5Li6aHRtbOWFg+e0oOS4uuagh+etvuWQjVxyXG4gICAgICAgICAgICAgICAgcHJvcHM6IHtcclxuICAgICAgICAgICAgICAgICAgICBrZXk6IFwiMVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHN0eWxlOiBcImNvbG9yOiUjcGNvbG9yIyUsd2lkdGg6MTAwcHgsaGVpZ2h0OjEwMHB4XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgb25jbGljazogXCJjbGlja0RpdigpXCJcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAvL3Byb3BzIGh0bWzlhYPntKDlsZ7mgKcs5YyF5ZCra2V5LHN0eWxl5Lul5Y+K5LqL5Lu2562J5L+h5oGv44CCa2V55Li65b+F5aGr77yM5LiN6IO96YeN5aSNXHJcbiAgICAgICAgICAgICAgICBjaGlsZHJlbjogW1wiJSNwYXJlbnQjJVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIC8vY2hpbGRyZW7kuLrlrZDoioLngrnmlbDnu4TvvIzlj6/ku6XljIXlkKvlrZfnrKbkuLLku6Xlj4romZrmi59kb23jgILmraTlpIRcIiUjcGFyZW50IyVcIuWPlueUqGRhdGEucGFyZW505pWw5o2u77yM5Zyo5riy5p+T5YmN5aGr5YWF5a2Q6IqC54K55Li655yf5a6e5pWw5o2u44CCZGF0YS5wYXJlbnTmlbDmja7lj5jljJbml7boh6rliqjpqbHliqjop4blm77mm7TmlrBcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZzogXCJwXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk6IFwiMlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU6IFwiY29sb3I6JSNjMWNvbG9yIyUsd2lkdGg6NTBweCxoZWlnaHQ6NTBweFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25jbGljazogXCJjbGlja1AxKClcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW1wiJSNjaGlsZCMlXCJdXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZzogXCJwXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk6IFwiM1wiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU6IFwiY29sb3I6JSNjMmNvbG9yIyUsd2lkdGg6NTBweCxoZWlnaHQ6NTBweFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25jbGljazogXCJjbGlja1AyKClcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW1wiJSNjaGlsZDIjJVwiXVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIF1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcblxyXG5cclxuICAgIHJ2LndhdGNoKFwicGFyZW50XCIsICgpID0+IHtcclxuICAgICAgICBhbGVydChcInBhcmVudCxjaGFuZ2VcIilcclxuICAgIH0pIC8vcnYud2F0Y2goXCJrZXlcIixjYWxsYmFjaykg6KeC5a+fZGF0YeaVsOaNruWvueixoeWvueW6lGtleeeahOaVsOWAvOWPmOWMlizlj5jljJbop6blj5FjYWxsYmFja1xyXG4gICAgcnYud2F0Y2goXCJjaGlsZFwiLCAoKSA9PiB7XHJcbiAgICAgICAgYWxlcnQoXCJjaGlsZCxjaGFuZ2VcIilcclxuICAgIH0pXHJcbiAgICBydi53YXRjaChcImNoaWxkMlwiLCAoKSA9PiB7XHJcbiAgICAgICAgYWxlcnQoXCJjaGlsZDIsY2hhbmdlXCIpXHJcbiAgICB9KVxyXG5cclxuICAgIFxyXG5cclxuXHJcbn1cclxuIiwiXHJcblxyXG5jb25zdCBOT0RFX1JFUExBQ0UgPSAwIC8vbm9kZSByZXBsYWNlIFxyXG5jb25zdCBDSElMRF9SRV9PUkRFUiA9IDEgLy9jaGlsZCBub2RlIHJlIG9yZGVyXHJcbmNvbnN0IE5PREVfUFJPUFMgPSAyIC8vcHJvcCBjaGFuZ2UgXHJcbmNvbnN0IE5PREVfQ09OVEVOVCA9IDMgLy9jb250ZW50IGNoYW5nZVxyXG5jbGFzcyBFbGVtZW50IHtcclxuICAgIC8qKlxyXG4gICAgICogdmlydHVhbCBkb20gb2JqZWN0IGNvbnN0cnVjdG9yXHJcbiAgICAgKiBAcGFyYW0geyp9IHRhZyAgdGhlIGh0bWwgdGFnIG5hbWVcclxuICAgICAqIEBwYXJhbSB7Kn0gcHJvcHMgIHRoZSBwcm9wIChrZXnvvIxzdHlsZS4uKVxyXG4gICAgICogQHBhcmFtIHsqfSBjaGlsZHJlbiBjaGlsZCBkYXRhXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKHRhZywgcHJvcHMsIGNoaWxkcmVuKSB7XHJcbiAgICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIEVsZW1lbnQpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgRWxlbWVudCh0YWdOYW1lLCBwcm9wcywgY2hpbGRyZW4pXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMudGFnID0gdGFnXHJcbiAgICAgICAgdGhpcy5wcm9wcyA9IHByb3BzIHx8IHt9XHJcbiAgICAgICAgdGhpcy5jaGlsZHJlbiA9IGNoaWxkcmVuIHx8IFtdXHJcbiAgICAgICAgdGhpcy5rZXkgPSBwcm9wcyA/IHByb3BzLmtleSA6IHVuZGVmaW5lZFxyXG4gICAgICAgIGlmICghdGhpcy5rZXkpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAke3RhZ30gLi4uIGh0bWwgdGFnIHRoZSBrZXkgaXMgdW5kZWZpbmVkYClcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGNvdW50ID0gMDtcclxuICAgICAgICB0aGlzLmNoaWxkcmVuLmZvckVhY2goY2hpbGQgPT4ge1xyXG4gICAgICAgICAgICBpZiAoY2hpbGQgaW5zdGFuY2VvZiBFbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICBjb3VudCArPSBjaGlsZC5jb3VudFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvdW50KytcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmNvdW50ID0gY291bnRcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogdGhlIG1ldGhvZCB1c2UgdG8gdmlydHVhbCBkb20gIHJlbmRlIHRvIHJlYWwgZG9tXHJcbiAgICAgKi9cclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICBjb25zdCBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGhpcy50YWcpXHJcbiAgICAgICAgY29uc3QgcHJvcHMgPSB0aGlzLnByb3BzXHJcbiAgICAgICAgZm9yIChjb25zdCBwcm9wTmFtZSBpbiBwcm9wcykge1xyXG4gICAgICAgICAgICBVdGlsLnNldEF0dHIoZWwsIHByb3BOYW1lLCBwcm9wc1twcm9wTmFtZV0pXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY2hpbGRyZW4uZm9yRWFjaChjaGlsZCA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNoaWxkRWwgPSAoY2hpbGQgaW5zdGFuY2VvZiBFbGVtZW50KSA/IGNoaWxkLnJlbmRlcigpIDogZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoY2hpbGQpXHJcbiAgICAgICAgICAgIGVsLmFwcGVuZENoaWxkKGNoaWxkRWwpXHJcbiAgICAgICAgfSlcclxuICAgICAgICByZXR1cm4gZWw7XHJcbiAgICB9XHJcbn1cclxuXHJcbmNsYXNzIERpZmYge1xyXG4gICAgLyoqXHJcbiAgICAgKiBkb20gdHJlZSBkaWZmIGFsZ29yaXRobSBvYmplY3QgY29uc3RydWN0b3JcclxuICAgICAqIEBwYXJhbSB7Kn0gb2xkVHJlZSB0aGUgZG9tIHRyZWUgZm9yIGJlZm9yZSB1cGRhdGUgXHJcbiAgICAgKiBAcGFyYW0geyp9IG5ld1RyZWUgdGhlIGRvbSB0cmVlIGZvciBhZnRlciB1cGRhdGVcclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3Iob2xkVHJlZSwgbmV3VHJlZSkge1xyXG4gICAgICAgIHRoaXMuaW5kZXggPSAwXHJcbiAgICAgICAgdGhpcy5wYXRjaGVzID0ge31cclxuICAgICAgICB0aGlzLmRmc1dhbGsob2xkVHJlZSwgbmV3VHJlZSwgdGhpcy5pbmRleClcclxuICAgIH1cclxuICAgIGRmc1dhbGsob2xkTm9kZSwgbmV3Tm9kZSwgaW5kZXgpIHtcclxuICAgICAgICBsZXQgY3VycmVudFBhdGNoID0gW11cclxuICAgICAgICBpZiAobmV3Tm9kZSA9PSBudWxsKSB7XHJcblxyXG4gICAgICAgIH0gZWxzZSBpZiAoVXRpbC5pc1N0cmluZyhvbGROb2RlKSAmJiBVdGlsLmlzU3RyaW5nKG5ld05vZGUpKSB7XHJcbiAgICAgICAgICAgIGlmIChvbGROb2RlICE9IG5ld05vZGUpIHtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRQYXRjaC5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBOT0RFX0NPTlRFTlQsXHJcbiAgICAgICAgICAgICAgICAgICAgY29udGVudDogbmV3Tm9kZVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSBpZiAob2xkTm9kZS50YWdOYW1lID09PSBuZXdOb2RlLnRhZ05hbWUgJiYgb2xkTm9kZS5rZXkgPT0gbmV3Tm9kZS5rZXkpIHtcclxuICAgICAgICAgICAgbGV0IHByb3BzUGF0Y2hlcyA9IHRoaXMuZGlmZlByb3BzKG9sZE5vZGUsIG5ld05vZGUpXHJcbiAgICAgICAgICAgIGlmIChwcm9wc1BhdGNoZXMpIHtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRQYXRjaC5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBOT0RFX1BST1BTLFxyXG4gICAgICAgICAgICAgICAgICAgIHByb3BzOiBwcm9wc1BhdGNoZXNcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCFVdGlsLmlzSWdub3JlQ2hpbGRyZW4obmV3Tm9kZSkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlmZkNoaWxkcmVuKG9sZE5vZGUuY2hpbGRyZW4sIG5ld05vZGUuY2hpbGRyZW4sIGluZGV4LCBjdXJyZW50UGF0Y2gpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjdXJyZW50UGF0Y2gucHVzaCh7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiBOT0RFX1JFUExBQ0UsXHJcbiAgICAgICAgICAgICAgICBub2RlOiBuZXdOb2RlXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjdXJyZW50UGF0Y2gubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGF0Y2hlc1tpbmRleF0gPSBjdXJyZW50UGF0Y2hcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBkaWZmUHJvcHMob2xkTm9kZSwgbmV3Tm9kZSkge1xyXG5cclxuICAgICAgICBjb25zdCBvbGRQcm9wcyA9IG9sZE5vZGUucHJvcHNcclxuICAgICAgICBjb25zdCBuZXdQcm9wcyA9IG5ld05vZGUucHJvcHNcclxuXHJcbiAgICAgICAgY29uc3QgcHJvcHNQYXRjaGVzID0ge31cclxuICAgICAgICBsZXQgaXNTYW1lID0gdHJ1ZTtcclxuICAgICAgICBmb3IgKGxldCBrZXkgaW4gb2xkUHJvcHMpIHtcclxuICAgICAgICAgICAgaWYgKG5ld1Byb3BzW2tleV0gIT09IG9sZFByb3BzW2tleV0pIHtcclxuICAgICAgICAgICAgICAgIGlzU2FtZSA9IGZhbHNlXHJcbiAgICAgICAgICAgICAgICBwcm9wc1BhdGNoZXNba2V5XSA9IG5ld1Byb3BzW2tleV1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKGxldCBrZXkgaW4gbmV3UHJvcHMpIHtcclxuICAgICAgICAgICAgaWYgKCFvbGRQcm9wcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICBpc1NhbWUgPSBmYWxzZVxyXG4gICAgICAgICAgICAgICAgcHJvcHNQYXRjaGVzW2tleV0gPSBuZXdQcm9wc1trZXldXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGlzU2FtZSA/IG51bGwgOiBwcm9wc1BhdGNoZXNcclxuXHJcbiAgICB9XHJcbiAgICBkaWZmQ2hpbGRyZW4ob2xkQ2hpbGRyZW4sIG5ld0NoaWxkcmVuLCBpbmRleCwgY3VycmVudFBhdGNoKSB7XHJcbiAgICAgICAgbGV0IGRpZmZMaXN0ID0gbmV3IERpZmZMaXN0KG9sZENoaWxkcmVuLCBuZXdDaGlsZHJlbilcclxuICAgICAgICBsZXQgZGlmZnMgPSBkaWZmTGlzdC5nZXRSZXN1bHQoKVxyXG4gICAgICAgIG5ld0NoaWxkcmVuID0gZGlmZnMuY2hpbGRcclxuICAgICAgICBpZiAoZGlmZnMubW92ZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGxldCByZW9yZGVyUGF0Y2ggPSB7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiBDSElMRF9SRV9PUkRFUixcclxuICAgICAgICAgICAgICAgIG1vdmVzOiBkaWZmcy5tb3Zlc1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGN1cnJlbnRQYXRjaC5wdXNoKHJlb3JkZXJQYXRjaClcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGxlZnROb2RlID0gbnVsbFxyXG4gICAgICAgIGxldCBjdXJyZW50Tm9kZUluZGV4ID0gaW5kZXhcclxuICAgICAgICBvbGRDaGlsZHJlbi5mb3JFYWNoKChjaGlsZCwgaSkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgbmV3Q2hpbGQgPSBuZXdDaGlsZHJlbltpXVxyXG4gICAgICAgICAgICBjdXJyZW50Tm9kZUluZGV4ID0gKGxlZnROb2RlICYmIGxlZnROb2RlLmNvdW50KSA/XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50Tm9kZUluZGV4ICsgbGVmdE5vZGUuY291bnQgKyAxIDpcclxuICAgICAgICAgICAgICAgIGN1cnJlbnROb2RlSW5kZXggKyAxXHJcbiAgICAgICAgICAgIHRoaXMuZGZzV2FsayhjaGlsZCwgbmV3Q2hpbGQsIGN1cnJlbnROb2RlSW5kZXgpXHJcbiAgICAgICAgICAgIGxlZnROb2RlID0gY2hpbGRcclxuICAgICAgICB9KVxyXG5cclxuXHJcbiAgICB9XHJcbn1cclxuXHJcbmNsYXNzIFBhdGNoIHtcclxuICAgIGNvbnN0cnVjdG9yKG5vZGUsIHBhdGNoZXMpIHtcclxuICAgICAgICBsZXQgd2Fsa2VyID0ge1xyXG4gICAgICAgICAgICBpbmRleDogMFxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmRmc1dhbGsobm9kZSwgd2Fsa2VyLCBwYXRjaGVzKVxyXG4gICAgfVxyXG4gICAgZGZzV2Fsayhub2RlLCB3YWxrZXIsIHBhdGNoZXMpIHtcclxuICAgICAgICBsZXQgY3VycmVudFBhdGNoZXMgPSBwYXRjaGVzW3dhbGtlci5pbmRleF1cclxuICAgICAgICBsZXQgbGVuID0gbm9kZS5jaGlsZE5vZGVzID8gbm9kZS5jaGlsZE5vZGVzLmxlbmd0aCA6IDBcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIGxldCBjaGlsZCA9IG5vZGUuY2hpbGROb2Rlc1tpXVxyXG4gICAgICAgICAgICB3YWxrZXIuaW5kZXgrK1xyXG4gICAgICAgICAgICB0aGlzLmRmc1dhbGsoY2hpbGQsIHdhbGtlciwgcGF0Y2hlcylcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGN1cnJlbnRQYXRjaGVzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXBwbHlQYXRjaGVzKG5vZGUsIGN1cnJlbnRQYXRjaGVzKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcbiAgICBhcHBseVBhdGNoZXMobm9kZSwgY3VycmVudFBhdGNoZSkge1xyXG4gICAgICAgIGN1cnJlbnRQYXRjaGUuZm9yRWFjaCgoY3VycmVudFBhdGNoKSA9PiB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAoY3VycmVudFBhdGNoLnR5cGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgTk9ERV9SRVBMQUNFOlxyXG4gICAgICAgICAgICAgICAgICAgIGxldCBuZXdOb2RlID0gVXRpbC5pc1N0cmluZyhjdXJyZW50UGF0Y2gubm9kZSkgPyBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShjdXJyZW50UGF0Y2gubm9kZSkgOiBjdXJyZW50UGF0Y2gubm9kZS5yZW5kZXIoKVxyXG4gICAgICAgICAgICAgICAgICAgIG5vZGUucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQobmV3Tm9kZSwgbm9kZSlcclxuICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgY2FzZSBDSElMRF9SRV9PUkRFUjpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlb3JkZXJDaGlsZHJlbihub2RlLCBjdXJyZW50UGF0Y2gubW92ZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICAgIGNhc2UgTk9ERV9QUk9QUzpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFByb3BzKG5vZGUsIGN1cnJlbnRQYXRjaC5wcm9wcylcclxuICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgY2FzZSBOT0RFX0NPTlRFTlQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUudGV4dENvbnRlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS50ZXh0Q29udGVudCA9IGN1cnJlbnRQYXRjaC5jb250ZW50XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5ub2RlVmFsdWUgPSBjdXJyZW50UGF0Y2guY29udGVudFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBicmVha1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbiAgICByZW9yZGVyQ2hpbGRyZW4obm9kZSwgbW92ZXMpIHtcclxuICAgICAgICBsZXQgc3RhdGljTm9kZUxpc3QgPSBVdGlsLnRvQXJyYXkobm9kZS5jaGlsZE5vZGVzKVxyXG4gICAgICAgIGxldCBub2RlTWFwcyA9IHt9XHJcbiAgICAgICAgc3RhdGljTm9kZUxpc3QuZm9yRWFjaCgoc25vZGUpID0+IHtcclxuICAgICAgICAgICAgaWYgKHNub2RlLm5vZGVUeXBlID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQga2V5ID0gc25vZGUuZ2V0QXR0cmlidXRlKCdrZXknKVxyXG4gICAgICAgICAgICAgICAgaWYgKGtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vZGVNYXBzW2tleV0gPSBzbm9kZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICBtb3Zlcy5mb3JFYWNoKChtb3ZlKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBpbmRleCA9IG1vdmUuaW5kZXhcclxuICAgICAgICAgICAgaWYgKG1vdmUudHlwZSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRpY05vZGVMaXN0W2luZGV4XSA9PT0gbm9kZS5jaGlsZE5vZGVzW2luZGV4XSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vZGUucmVtb3ZlQ2hpbGQobm9kZS5jaGlsZE5vZGVzW2luZGV4XSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHN0YXRpY05vZGVMaXN0LnNwbGljZShpbmRleCwgMSlcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChtb3ZlLnR5cGUgPT09IDEpIHtcclxuICAgICAgICAgICAgICAgIGxldCBpbnNlcnROb2RlID0gbm9kZU1hcHNbbW92ZS5pdGVtLmtleV0gP1xyXG4gICAgICAgICAgICAgICAgICAgIG5vZGVNYXBzKG1vdmUuaXRlbS5rZXkpLmNsb25lTm9kZSh0cnVlKSA6XHJcbiAgICAgICAgICAgICAgICAgICAgVXRpbC5pc1N0cmluZyhtb3ZlLml0ZW0pID8gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUobW92ZS5pdGVtKSA6IG1vdmUuaXRlbS5yZW5kZXIoKVxyXG4gICAgICAgICAgICAgICAgc3RhdGljTm9kZUxpc3Quc3BsaWNlKGluZGV4LCAwLCBpbnNlcnROb2RlKVxyXG4gICAgICAgICAgICAgICAgbm9kZS5pbnNlcnRCZWZvcmUoaW5zZXJ0Tm9kZSwgbm9kZS5jaGlsZE5vZGVzW2luZGV4XSB8fCBudWxsKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICB9XHJcbiAgICBzZXRQcm9wcyhub2RlLCBwcm9wcykge1xyXG4gICAgICAgIGZvciAobGV0IGtleSBpbiBwcm9wcykge1xyXG4gICAgICAgICAgICBpZiAocHJvcHNba2V5XSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICBub2RlLnJlbW92ZUF0dHJpYnV0ZShrZXkpXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHByb3BzW2tleV1cclxuICAgICAgICAgICAgICAgIFV0aWwuc2V0QXR0cihub2RlLCBrZXksIHZhbHVlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxufVxyXG5cclxuXHJcblxyXG5cclxuY2xhc3MgVXRpbCB7XHJcbiAgICBzdGF0aWMgaXNTdHJpbmcoc29tZSkge1xyXG4gICAgICAgIHJldHVybiB0eXBlb2Ygc29tZSA9PT0gJ3N0cmluZydcclxuICAgIH1cclxuICAgIHN0YXRpYyB0b0FycmF5KGxpc3QpIHtcclxuICAgICAgICBpZiAoIWxpc3QpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFtdXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBhcnJheSA9IFtdXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGFycmF5LnB1c2gobGlzdFtpXSlcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGFycmF5XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgaXNGb3JJbihkaXJlY3Rpb24pIHtcclxuICAgICAgICByZXR1cm4gL15cXHcqIF9pbl8gXFx3KiQvLnRlc3QoZGlyZWN0aW9uKVxyXG4gICAgfVxyXG4gICAgc3RhdGljIGlzRm9yRm9ySW4oZGlyZWN0aW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIC9eXFx3KiBfaW4qJC8udGVzdChkaXJlY3Rpb24pXHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIGlzRm9yT3JGb3JGb3IoZGlyZWN0aW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIC9eXFx3KiBfaW5fIFxcd3xfaW4qJC8udGVzdChkaXJlY3Rpb24pXHJcbiAgICB9XHJcbiAgICBzdGF0aWMgaXNJZ25vcmVDaGlsZHJlbihub2RlKSB7XHJcbiAgICAgICAgcmV0dXJuIG5vZGUucHJvcHMgJiYgbm9kZS5wcm9wcy5oYXNPd25Qcm9wZXJ0eShcImlnbm9yZVwiKVxyXG4gICAgfVxyXG4gICAgc3RhdGljIGlzTnVtYmVyKHZhbHVlKSB7XHJcbiAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09ICcnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHR5cGVvZiAodmFsdWUpID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAvL+ato+aVtOaVsFxyXG4gICAgICAgICAgICB2YXIgcmVOdW1iZXIgPSAvXlxcZCskL1xyXG4gICAgICAgICAgICAvL+i0n+aVtOaVsFxyXG4gICAgICAgICAgICB2YXIgcmVOZU51bWJlciA9IC9eLVxcZCskL1xyXG4gICAgICAgICAgICAvL+ato+WunuaVsFxyXG4gICAgICAgICAgICB2YXIgcmVSZWFsTnVtYmVyMSA9IC9eWzEtOV1cXGQqWy5dXFxkKyQvICAvL+mdnumbtuW8gOWktFxyXG4gICAgICAgICAgICB2YXIgcmVSZWFsTnVtYmVyMiA9IC9eMFsuXVxcZCskLyAvL+mbtuW8gOWktFxyXG4gICAgICAgICAgICAvL+i0n+WunuaVsFxyXG4gICAgICAgICAgICB2YXIgcmVOZVJlYWxOdW1iZXIxID0gL14tWzEtOV1cXGQqWy5dXFxkKyQvICAvL+mdnumbtuW8gOWktFxyXG4gICAgICAgICAgICB2YXIgcmVOZVJlYWxOdW1iZXIyID0gL14tMFsuXVxcZCskLyAvL+mbtuW8gOWktFxyXG5cclxuICAgICAgICAgICAgaWYgKHJlTnVtYmVyLnRlc3QodmFsdWUpIHx8IHJlTmVOdW1iZXIudGVzdCh2YWx1ZSlcclxuICAgICAgICAgICAgICAgIHx8IHJlUmVhbE51bWJlcjEudGVzdCh2YWx1ZSkgfHwgcmVSZWFsTnVtYmVyMi50ZXN0KHZhbHVlKVxyXG4gICAgICAgICAgICAgICAgfHwgcmVOZVJlYWxOdW1iZXIxLnRlc3QodmFsdWUpIHx8IHJlTmVSZWFsTnVtYmVyMi50ZXN0KHZhbHVlKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiAodmFsdWUpID09PSAnbnVtYmVyJykge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBzdGF0aWMgc2V0QXR0cihub2RlLCBrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgc3dpdGNoIChrZXkpIHtcclxuICAgICAgICAgICAgY2FzZSAnc3R5bGUnOlxyXG4gICAgICAgICAgICAgICAgbm9kZS5zdHlsZS5jc3NUZXh0ID0gdmFsdWVcclxuICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgIGNhc2UgJ3ZhbHVlJzpcclxuICAgICAgICAgICAgICAgIGxldCB0YWdOYW1lID0gbm9kZS50YWdOYW1lIHx8ICcnXHJcbiAgICAgICAgICAgICAgICB0YWdOYW1lID0gdGFnTmFtZS50b0xvd2VyQ2FzZSgpXHJcbiAgICAgICAgICAgICAgICBpZiAodGFnTmFtZSA9PT0gJ2lucHV0JyB8fCB0YWdOYW1lID09PSAndGV4dGFyZWEnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm9kZS52YWx1ZSA9IHZhbHVlXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKGtleSwgdmFsdWUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoa2V5LCB2YWx1ZSlcclxuICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuICAgIHN0YXRpYyBpc1BsYWNlSG9sZGVyKGNvbnRlbnQpIHtcclxuICAgICAgICBpZiAoY29udGVudCkge1xyXG4gICAgICAgICAgICBpZiAoL14lI1xcdyouXFx3KiMlJC8udGVzdChjb250ZW50KSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgc3RhdGljIGlzRG90T3BlcmF0b3JFeHByZXNzaW9uKGNvbnRlbnQpIHtcclxuICAgICAgICByZXR1cm4gL15cXHcqXFwuXFx3KiQvLnRlc3QoY29udGVudClcclxuICAgIH1cclxuICAgIHN0YXRpYyBnZXRQbGFjZUhvbGRlclZhbHVlKGNvbnRlbnQpIHtcclxuICAgICAgICByZXR1cm4gY29udGVudC5zbGljZSgyLCAtMilcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5piv5ZCm5Li66KGo6L6+5byPXHJcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gY29udGVudCBcclxuICAgICAqL1xyXG4gICAgc3RhdGljIGlzT3BlcmF0b3JFeHByZXNzaW9uKGNvbnRlbnQpIHtcclxuXHJcbiAgICAgICAgaWYgKFV0aWwuaXNTdHJpbmcoY29udGVudCkpIHtcclxuICAgICAgICAgICAgaWYgKC9eXFx7XFx3KnxcXHxcXCUrXFx9JC8udGVzdChjb250ZW50KSkge1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICB9XHJcbiAgICBzdGF0aWMgZ2V0T3BlcmF0b3JFeHByZXNzaW9uKGNvbnRlbnQsIGRhdGEsIGRhdGFLZXkpIHtcclxuICAgICAgICBpZiAoVXRpbC5pc1N0cmluZyhjb250ZW50KSkge1xyXG5cclxuICAgICAgICAgICAgdmFyIGV4cHJlc3Npb24gPSBjb250ZW50LnNsaWNlKGNvbnRlbnQuaW5kZXhPZihcIntcIikgKyAxLCBjb250ZW50LmluZGV4T2YoXCJ9XCIpKVxyXG4gICAgICAgICAgICBsZXQgc3RhcnRJbmRleCA9IGV4cHJlc3Npb24uaW5kZXhPZihcIiUjXCIpXHJcbiAgICAgICAgICAgIGxldCBlbmRJbmRleCA9IGV4cHJlc3Npb24uaW5kZXhPZihcIiMlXCIpICsgMlxyXG4gICAgICAgICAgICBpZiAoc3RhcnRJbmRleCAhPSAtMSAmJiBlbmRJbmRleCAhPSAtMSAmJiBzdGFydEluZGV4IDwgZW5kSW5kZXgpIHtcclxuICAgICAgICAgICAgICAgIGxldCBwbGFjZUhvbGRlciA9IGV4cHJlc3Npb24uc2xpY2Uoc3RhcnRJbmRleCwgZW5kSW5kZXgpXHJcbiAgICAgICAgICAgICAgICBsZXQgcmVhbFZhbHVlXHJcbiAgICAgICAgICAgICAgICBpZiAocGxhY2VIb2xkZXIuaW5kZXhPZihcIi5cIikgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKFV0aWwuZ2V0UGxhY2VIb2xkZXJWYWx1ZShwbGFjZUhvbGRlcikuc3BsaXQoXCIuXCIpWzBdID09PSBkYXRhS2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwbGFjZUhvbGRlclZhbHVlID0gZGF0YVtVdGlsLmdldFBsYWNlSG9sZGVyVmFsdWUocGxhY2VIb2xkZXIpLnNwbGl0KFwiLlwiKVsxXV1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVhbFZhbHVlID0gVXRpbC5pc051bWJlcihwbGFjZUhvbGRlclZhbHVlKSA/IHBsYWNlSG9sZGVyVmFsdWUgOiBgXCIke3BsYWNlSG9sZGVyVmFsdWV9XCJgLy/pgJrov4dwbGFjZUhvbGRlcuWPluecn+WunueahOWAvFxyXG5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVhbFZhbHVlID0gZGF0YVtVdGlsLmdldFBsYWNlSG9sZGVyVmFsdWUocGxhY2VIb2xkZXIpXS8v6YCa6L+HcGxhY2VIb2xkZXLlj5bnnJ/lrp7nmoTlgLxcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBleHByZXNzaW9uID0gZXhwcmVzc2lvbi5yZXBsYWNlKHBsYWNlSG9sZGVyLCByZWFsVmFsdWUpXHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBldmFsKGV4cHJlc3Npb24pXHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG5jbGFzcyBEaWZmTGlzdCB7XHJcbiAgICAvKipcclxuICAgICAqIGRpZmYgbGlzdCBcclxuICAgICAqIEBwYXJhbSB7Kn0gb2xkTGlzdCBcclxuICAgICAqIEBwYXJhbSB7Kn0gbmV3TGlzdCBcclxuICAgICAqIEBwYXJhbSB7Kn0ga2V5IFxyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3RvcihvbGRMaXN0LCBuZXdMaXN0KSB7XHJcbiAgICAgICAgbGV0IG9sZExpc3RLZXlJbmRleCA9IHRoaXMubWFrZUtleUluZGV4KG9sZExpc3QpLmtleUluZGV4XHJcbiAgICAgICAgbGV0IG5ld0xpc3RLZXlJbmRleCA9IHRoaXMubWFrZUtleUluZGV4KG5ld0xpc3QpLmtleUluZGV4XHJcbiAgICAgICAgdGhpcy5tb3ZlT3BlcmF0b3IgPSBbXVxyXG4gICAgICAgIHRoaXMuY2hpbGRMaXN0ID0gW11cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG9sZExpc3QubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgbGV0IG9sZEl0ZW0gPSBvbGRMaXN0W2ldXHJcbiAgICAgICAgICAgIGxldCBvSXRlbUtleSA9IHRoaXMuZ2V0S2V5KG9sZEl0ZW0pXHJcbiAgICAgICAgICAgIGlmICghbmV3TGlzdEtleUluZGV4Lmhhc093blByb3BlcnR5KG9JdGVtS2V5KSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGlsZExpc3QucHVzaChudWxsKVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGlsZExpc3QucHVzaChuZXdMaXN0W25ld0xpc3RLZXlJbmRleFtvSXRlbUtleV1dKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMudGVtcExpc3QgPSB0aGlzLmNoaWxkTGlzdC5zbGljZSgwKVxyXG4gICAgICAgIGxldCBpID0gMDtcclxuICAgICAgICB3aGlsZSAoaSA8IHRoaXMudGVtcExpc3QubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnRlbXBMaXN0W2ldID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZShpKVxyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVDb3B5VGVtcExpc3QoaSlcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGkrK1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBpbmRleCA9IDBcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5ld0xpc3QubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgbGV0IG5JdGVtID0gbmV3TGlzdFtpXVxyXG4gICAgICAgICAgICBsZXQgbkl0ZW1LZXkgPSB0aGlzLmdldEtleShuSXRlbSlcclxuICAgICAgICAgICAgbGV0IGNJdGVtID0gdGhpcy50ZW1wTGlzdFtpbmRleF1cclxuICAgICAgICAgICAgbGV0IGNJdGVtS2V5ID0gdGhpcy5nZXRLZXkoY0l0ZW0pXHJcbiAgICAgICAgICAgIGlmIChjSXRlbSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG5JdGVtS2V5ICE9IGNJdGVtS2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9sZExpc3RLZXlJbmRleC5oYXNPd25Qcm9wZXJ0eShuSXRlbUtleSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNOZXh0SXRlbUtleSA9IGdldEtleSh0aGlzLnRlbXBMaXN0W2luZGV4ICsgMV0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuSXRlbUtleSA9PT0gY05leHRJdGVtS2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZShpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVDb3B5VGVtcExpc3QoaW5kZXgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleCsrXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmluc2VydChpLCBuSXRlbSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW5zZXJ0KGksIG5JdGVtKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5kZXgrK1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbnNlcnQoaSwgbkl0ZW0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGsgPSB0aGlzLnRlbXBMaXN0Lmxlbmd0aCAtIGluZGV4XHJcbiAgICAgICAgd2hpbGUgKGluZGV4KysgPCB0aGlzLnRlbXBMaXN0Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICBrLS1cclxuICAgICAgICAgICAgdGhpcy5yZW1vdmUoayArIG5ld0xpc3QubGVuZ3RoKVxyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgfVxyXG4gICAgbWFrZUtleUluZGV4KGxpc3QpIHtcclxuICAgICAgICBsZXQga2V5SW5kZXggPSB7fVxyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBsZXQgaXRlbSA9IGxpc3RbaV1cclxuICAgICAgICAgICAgbGV0IGl0ZW1LZXkgPSB0aGlzLmdldEtleShpdGVtKVxyXG4gICAgICAgICAgICBrZXlJbmRleFtpdGVtS2V5XSA9IGlcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAga2V5SW5kZXg6IGtleUluZGV4XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldEtleShpdGVtKSB7XHJcbiAgICAgICAgaWYgKCFpdGVtKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWRcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGl0ZW1bXCJrZXlcIl1cclxuICAgIH1cclxuICAgIHJlbW92ZUNvcHlUZW1wTGlzdChpbmRleCkge1xyXG4gICAgICAgIHRoaXMudGVtcExpc3Quc3BsaWNlKGluZGV4LCAxKVxyXG4gICAgfVxyXG4gICAgcmVtb3ZlKGluZGV4KSB7XHJcbiAgICAgICAgdGhpcy5tb3ZlT3BlcmF0b3IucHVzaCh7XHJcbiAgICAgICAgICAgIGluZGV4OiBpbmRleCxcclxuICAgICAgICAgICAgdHlwZTogMFxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgaW5zZXJ0KGluZGV4LCBpdGVtKSB7XHJcbiAgICAgICAgdGhpcy5tb3ZlT3BlcmF0b3IucHVzaCh7XHJcbiAgICAgICAgICAgIGluZGV4OiBpbmRleCxcclxuICAgICAgICAgICAgaXRlbTogaXRlbSxcclxuICAgICAgICAgICAgdHlwZTogMVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0UmVzdWx0KCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIG1vdmVzOiB0aGlzLm1vdmVPcGVyYXRvcixcclxuICAgICAgICAgICAgY2hpbGQ6IHRoaXMuY2hpbGRMaXN0XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5cclxuXHJcbmZ1bmN0aW9uIG9ic2VydmUob2JqLCBvYnNlcnZlTWFwLCBjYWxsYmFjaykge1xyXG5cclxuICAgIE9iamVjdC5rZXlzKG9iaikuZm9yRWFjaChrZXkgPT4ge1xyXG4gICAgICAgIGxldCBpbnRlcm5hbFZhbHVlID0gb2JqW2tleV1cclxuICAgICAgICBsZXQgb2JzZXJ2YWJsZSA9IG5ldyBPYnNlcnZhYmxlKClcclxuICAgICAgICBvYnNlcnZlTWFwLnB1dChrZXksIG9ic2VydmFibGUpXHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7XHJcbiAgICAgICAgICAgIGdldCgpIHtcclxuICAgICAgICAgICAgICAgIG9ic2VydmFibGUuYWRkKGNhbGxiYWNrKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGludGVybmFsVmFsdWVcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2V0KG5ld1ZhbCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlZCA9IGludGVybmFsVmFsdWUgIT09IG5ld1ZhbFxyXG4gICAgICAgICAgICAgICAgaW50ZXJuYWxWYWx1ZSA9IG5ld1ZhbFxyXG4gICAgICAgICAgICAgICAgaWYgKGNoYW5nZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBvYnNlcnZhYmxlLmludm9rZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfSlcclxuICAgIHJldHVybiBvYmpcclxufVxyXG5cclxuXHJcblxyXG5mdW5jdGlvbiBPYnNlcnZhYmxlKCkge1xyXG4gICAgdGhpcy51cGRhdGVGdW5jdGlvbnMgPSBuZXcgU2V0KClcclxufVxyXG5PYnNlcnZhYmxlLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAob2JzZXJ2YWJsZVVwZGF0ZSkge1xyXG4gICAgdGhpcy51cGRhdGVGdW5jdGlvbnMuYWRkKG9ic2VydmFibGVVcGRhdGUpXHJcbn1cclxuT2JzZXJ2YWJsZS5wcm90b3R5cGUuaW52b2tlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy51cGRhdGVGdW5jdGlvbnMuZm9yRWFjaChmdW4gPT4gZnVuKCkpXHJcbn1cclxuXHJcblxyXG4vKipcclxuICogdGhlIG1ldGhvZCB1c2UgdG8gZGVlcCBjbG9uZSBvYmpcclxuICogQHBhcmFtIHsqfSBvYmogXHJcbiAqL1xyXG5mdW5jdGlvbiBjbG9uZShvYmopIHtcclxuICAgIGxldCBnZXRUeXBlID0gKG8pID0+IHtcclxuICAgICAgICBpZiAobyA9PT0gbnVsbCkgcmV0dXJuIFwibnVsbFwiO1xyXG4gICAgICAgIGlmIChvID09PSB1bmRlZmluZWQpIHJldHVybiBcInVuZGVmaW5lZFwiO1xyXG4gICAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpO1xyXG4gICAgfVxyXG4gICAgbGV0IHJlc3VsdCwgb0NsYXNzID0gZ2V0VHlwZShvYmopO1xyXG4gICAgaWYgKG9DbGFzcyA9PT0gXCJPYmplY3RcIikge1xyXG4gICAgICAgIHJlc3VsdCA9IHt9O1xyXG4gICAgfSBlbHNlIGlmIChvQ2xhc3MgPT09IFwiQXJyYXlcIikge1xyXG4gICAgICAgIHJlc3VsdCA9IFtdO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gb2JqO1xyXG4gICAgfVxyXG4gICAgZm9yIChrZXkgaW4gb2JqKSB7XHJcbiAgICAgICAgbGV0IGNvcHkgPSBvYmpba2V5XTtcclxuICAgICAgICBpZiAoZ2V0VHlwZShjb3B5KSA9PSBcIk9iamVjdFwiKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdFtrZXldID0gYXJndW1lbnRzLmNhbGxlZShjb3B5KTtcclxuICAgICAgICB9IGVsc2UgaWYgKGdldFR5cGUoY29weSkgPT0gXCJBcnJheVwiKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdFtrZXldID0gYXJndW1lbnRzLmNhbGxlZShjb3B5KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXN1bHRba2V5XSA9IG9ialtrZXldO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBoKHRhZ05hbWUsIHByb3BzLCBjaGlsZHJlbikge1xyXG4gICAgcmV0dXJuIG5ldyBFbGVtZW50KHRhZ05hbWUsIHByb3BzLCBjaGlsZHJlbilcclxufVxyXG5cclxuZnVuY3Rpb24gZGlmZihvbGRUcmVlLCBuZXdUcmVlKSB7XHJcbiAgICBsZXQgZCA9IG5ldyBEaWZmKG9sZFRyZWUsIG5ld1RyZWUpXHJcbiAgICByZXR1cm4gZC5wYXRjaGVzXHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBwYXRjaChub2RlLCBwYXRjaGVzKSB7XHJcbiAgICByZXR1cm4gbmV3IFBhdGNoKG5vZGUsIHBhdGNoZXMpXHJcbn1cclxuLyoqXHJcbiAqIHRoZSBtYXAgb2JqZWN0IHVzZSB0byBzYXZlIGxpa2lseSAoa2V5LHZhbHVlKSBkYXRhXHJcbiAqL1xyXG5jbGFzcyBNYXAge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5sZW5ndGggPSAwO1xyXG4gICAgICAgIHRoaXMubWFwID0gbmV3IE9iamVjdCgpO1xyXG4gICAgfVxyXG4gICAgcHV0KGtleSwgdmFsdWUpIHtcclxuICAgICAgICBpZiAoIShrZXkgaW4gdGhpcy5tYXApKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGVuZ3RoKys7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubWFwW2tleV0gPSB2YWx1ZTtcclxuICAgIH1cclxuICAgIGdldChrZXkpIHtcclxuICAgICAgICByZXR1cm4gKGtleSBpbiB0aGlzLm1hcCkgPyB0aGlzLm1hcFtrZXldIDogbnVsbDtcclxuICAgIH1cclxuICAgIHJlbW92ZShrZXkpIHtcclxuICAgICAgICBpZiAoKGtleSBpbiB0aGlzLm1hcCkpIHtcclxuICAgICAgICAgICAgZGVsZXRlIHRoaXMubWFwW2tleV1cclxuICAgICAgICAgICAgdGhpcy5sZW5ndGgtLTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBzaXplKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxlbmd0aDtcclxuICAgIH1cclxuICAgIGNsZWFyKCkge1xyXG4gICAgICAgIGxlbmd0aCA9IDA7XHJcbiAgICAgICAgdGhpcy5tYXAgPSBuZXcgT2JqZWN0KCk7XHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG5jbGFzcyBSViB7XHJcbiAgICBjb25zdHJ1Y3RvcihvcHRpb24pIHtcclxuICAgICAgICBjb25zdCB7XHJcbiAgICAgICAgICAgIGVsLFxyXG4gICAgICAgICAgICBkYXRhLFxyXG4gICAgICAgICAgICBkb21cclxuICAgICAgICB9ID0gb3B0aW9uXHJcbiAgICAgICAgbGV0IHJvb3QgPSBVdGlsLmlzU3RyaW5nKGVsKSA/IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZWwpIDogZWxcclxuICAgICAgICB0aGlzLmRhdGEgPSBkYXRhXHJcbiAgICAgICAgdGhpcy52ZSA9IHRoaXMuZ2V0VmlydHVhbEVsZW1lbnQodGhpcy5hcHBseVRydXRoZnVsRGF0YShkb20pKVxyXG4gICAgICAgIHRoaXMudyA9IHRoaXMudmUucmVuZGVyKClcclxuICAgICAgICByb290LmFwcGVuZENoaWxkKHRoaXMudylcclxuICAgICAgICB0aGlzLm9ic2VydmVNYXAgPSBuZXcgTWFwKClcclxuICAgICAgICBvYnNlcnZlKHRoaXMuZGF0YSwgdGhpcy5vYnNlcnZlTWFwLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlZG9tKGRvbSlcclxuICAgICAgICB9KVxyXG4gICAgICAgIHRoaXMudXBkYXRlZG9tKGRvbSlcclxuXHJcbiAgICB9XHJcbiAgICB1cGRhdGVkb20oZG9tKSB7XHJcbiAgICAgICAgbGV0IG52ZSA9IHRoaXMuZ2V0VmlydHVhbEVsZW1lbnQodGhpcy5hcHBseVRydXRoZnVsRGF0YShkb20pKVxyXG4gICAgICAgIHdpbmRvdy5udmUgPSBudmVcclxuICAgICAgICB3aW5kb3cudmUgPSB0aGlzLnZlXHJcbiAgICAgICAgcGF0Y2godGhpcy53LCBkaWZmKHRoaXMudmUsIG52ZSkpXHJcbiAgICAgICAgdGhpcy52ZSA9IG52ZVxyXG4gICAgfVxyXG4gICAgd2F0Y2goa2V5LCBjYWxsYmFjaykge1xyXG4gICAgICAgIHRoaXMub2JzZXJ2ZU1hcC5nZXQoa2V5KS5hZGQoY2FsbGJhY2spXHJcbiAgICB9XHJcbiAgICBnZXRWaXJ0dWFsRWxlbWVudChkb20pIHtcclxuICAgICAgICBsZXQgY2hpbGRyZW4gPSBbXVxyXG4gICAgICAgIGZvciAobGV0IGNoaWxkIGluIGRvbS5jaGlsZHJlbikge1xyXG4gICAgICAgICAgICBsZXQgY2MgPSBkb20uY2hpbGRyZW5bY2hpbGRdXHJcbiAgICAgICAgICAgIGlmIChjYyBpbnN0YW5jZW9mIEFycmF5KSB7XHJcbiAgICAgICAgICAgICAgICBjYy5mb3JFYWNoKGMgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCB2ID0gdGhpcy5nZXRWaXJ0dWFsRWxlbWVudChjKVxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuLnB1c2godilcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY2MgaW5zdGFuY2VvZiBPYmplY3QpIHtcclxuICAgICAgICAgICAgICAgIGxldCB2ID0gdGhpcy5nZXRWaXJ0dWFsRWxlbWVudChjYylcclxuICAgICAgICAgICAgICAgIGNoaWxkcmVuLnB1c2godilcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNoaWxkcmVuLnB1c2goY2MpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBoKGRvbS50YWcsIGRvbS5wcm9wcywgY2hpbGRyZW4pXHJcbiAgICB9XHJcbiAgICBhcHBseVRydXRoZnVsRGF0YShkb20pIHtcclxuICAgICAgICBpZiAoXCJmb3JcIiBpbiBkb20ucHJvcHMpIHtcclxuICAgICAgICAgICAgbGV0IGRhdGFBcnJheSA9IFtdXHJcbiAgICAgICAgICAgIGxldCBkYXRhU2luZ2xlXHJcblxyXG4gICAgICAgICAgICBpZiAoVXRpbC5pc0ZvckluKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoXCJjaGlsZERvbURhdGFrZXlcIiBpbiBkb20pIHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhQXJyYXkgPSBkb20uZGF0YVxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFTaW5nbGUgPSBkb20uY2hpbGREb21EYXRha2V5XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFwiZG9tRGF0YUtleVwiIGluIGRvbSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChkb20ucHJvcHNbJ2ZvciddLnNwbGl0KFwiIF9pbl8gXCIpWzFdID09PSBkb20uZG9tRGF0YUtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhQXJyYXkgPSBkb20uZGF0YVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBkYXRhU2luZ2xlID0gZG9tLnByb3BzWydmb3InXS5zcGxpdChcIiBfaW5fIFwiKVswXVxyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFBcnJheSA9IHRoaXMuZGF0YVtkb20ucHJvcHNbJ2ZvciddLnNwbGl0KFwiIF9pbl8gXCIpWzFdXVxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFTaW5nbGUgPSBkb20ucHJvcHNbJ2ZvciddLnNwbGl0KFwiIF9pbl8gXCIpWzBdXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwidGhlIGZvciBkaXJlY3RpdmUgdXNlIGVycm9yXCIpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbGV0IG9ianMgPSBbXVxyXG4gICAgICAgICAgICBkYXRhQXJyYXkuZm9yRWFjaChkYXRhID0+IHtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgb2JqID0gdGhpcy52ZG9tMnJkb20oZG9tLCBkYXRhLCBkYXRhU2luZ2xlLCBkYXRhKVxyXG5cclxuICAgICAgICAgICAgICAgIG9ianMucHVzaChvYmopXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICAgICAgcmV0dXJuIG9ianNcclxuICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgbGV0IGRhdGFcclxuICAgICAgICAgICAgbGV0IGNoaWxkRG9tRGF0YWtleVxyXG4gICAgICAgICAgICBpZiAoXCJkYXRhXCIgaW4gZG9tKSB7XHJcbiAgICAgICAgICAgICAgICBkYXRhID0gZG9tLmRhdGFcclxuICAgICAgICAgICAgICAgIGNoaWxkRG9tRGF0YWtleSA9IGRvbS5jaGlsZERvbURhdGFrZXlcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGRhdGEgPSB0aGlzLmRhdGFcclxuICAgICAgICAgICAgICAgIGNoaWxkRG9tRGF0YWtleSA9IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBsZXQgb2JqID0gdGhpcy52ZG9tMnJkb20oZG9tLCBkYXRhLCBjaGlsZERvbURhdGFrZXksIHRoaXMuZGF0YSlcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBvYmpcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIHZpcnR1YWwgZG9tIDIgcmVhbCBkYXRhIGRvbVxyXG4gICAgICogQHBhcmFtIHsqfSBkb20gXHJcbiAgICAgKiBAcGFyYW0geyp9IGRhdGEgXHJcbiAgICAgKiBAcGFyYW0geyp9IGRhdGFTaW5nbGUgXHJcbiAgICAgKiBAcGFyYW0geyp9IHRkYXRhIFxyXG4gICAgICovXHJcbiAgICB2ZG9tMnJkb20oZG9tLCBkYXRhLCBkYXRhU2luZ2xlLCB0ZGF0YSkge1xyXG4gICAgICAgIGxldCBvYmogPSB7fVxyXG4gICAgICAgIG9iai50YWcgPSBkb20udGFnXHJcbiAgICAgICAgb2JqLmNoaWxkcmVuID0gW11cclxuICAgICAgICBvYmoucHJvcHMgPSB7fVxyXG4gICAgICAgIGxldCBwcm9wcyA9IE9iamVjdC5rZXlzKGRvbS5wcm9wcylcclxuICAgICAgICBmb3IgKGxldCBwcm9wIGluIHByb3BzKSB7XHJcbiAgICAgICAgICAgIGxldCB2YWx1ZSA9IHByb3BzW3Byb3BdXHJcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gXCJzdHlsZVwiKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgc3R5bGUgPSBkb20ucHJvcHNbdmFsdWVdXHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHN0eWxlLmluZGV4T2YoXCIsXCIpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgc3R5bGVzID0gc3R5bGUuc3BsaXQoXCIsXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgb2JqLnByb3BzW3ZhbHVlXSA9IHRoaXMuaGFuZGxlQXJyYXlTdHlsZShkYXRhLCBzdHlsZXMsIGRhdGFTaW5nbGUpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBvYmoucHJvcHNbdmFsdWVdID0gdGhpcy5oYW5kbGVTaW5nbGVTdHlsZShkYXRhLCBzdHlsZSwgZGF0YVNpbmdsZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChVdGlsLmlzUGxhY2VIb2xkZXIoZG9tLnByb3BzW3ZhbHVlXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIVV0aWwuaXNEb3RPcGVyYXRvckV4cHJlc3Npb24oVXRpbC5nZXRQbGFjZUhvbGRlclZhbHVlKGRvbS5wcm9wc1t2YWx1ZV0pKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvYmoucHJvcHNbdmFsdWVdID0gdGRhdGFbVXRpbC5nZXRQbGFjZUhvbGRlclZhbHVlKGRvbS5wcm9wc1t2YWx1ZV0pXVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iai5wcm9wc1t2YWx1ZV0gPSBkYXRhW1V0aWwuZ2V0UGxhY2VIb2xkZXJWYWx1ZShkb20ucHJvcHNbdmFsdWVdKS5zcGxpdChcIi5cIilbMV1dXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChVdGlsLmlzT3BlcmF0b3JFeHByZXNzaW9uKGRvbS5wcm9wc1t2YWx1ZV0pKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIG9iai5wcm9wc1t2YWx1ZV0gPSBVdGlsLmdldE9wZXJhdG9yRXhwcmVzc2lvbihkb20ucHJvcHNbdmFsdWVdLCBkYXRhLCBkYXRhU2luZ2xlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb2JqLnByb3BzW3ZhbHVlXSA9IGRvbS5wcm9wc1t2YWx1ZV1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKGxldCBjaGlsZCBpbiBkb20uY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgaWYgKFV0aWwuaXNTdHJpbmcoZG9tLmNoaWxkcmVuW2NoaWxkXSkpIHtcclxuICAgICAgICAgICAgICAgIGlmIChVdGlsLmlzUGxhY2VIb2xkZXIoZG9tLmNoaWxkcmVuW2NoaWxkXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoVXRpbC5nZXRQbGFjZUhvbGRlclZhbHVlKGRvbS5jaGlsZHJlbltjaGlsZF0pLmluZGV4T2YoZGF0YVNpbmdsZSkgPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb2JqLmNoaWxkcmVuW2NoaWxkXSA9IHRkYXRhW1V0aWwuZ2V0UGxhY2VIb2xkZXJWYWx1ZShkb20uY2hpbGRyZW5bY2hpbGRdKV1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb2JqLmNoaWxkcmVuW2NoaWxkXSA9IGRhdGFbVXRpbC5nZXRQbGFjZUhvbGRlclZhbHVlKGRvbS5jaGlsZHJlbltjaGlsZF0pLnNwbGl0KFwiLlwiKVsxXV1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb2JqLmNoaWxkcmVuW2NoaWxkXSA9IGRvbS5jaGlsZHJlbltjaGlsZF1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZG9tLmNoaWxkcmVuW2NoaWxkXSBpbnN0YW5jZW9mIE9iamVjdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChcImNoaWxkRG9tRGF0YVwiIGluIGRvbS5wcm9wcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb20uY2hpbGRyZW5bY2hpbGRdLmNoaWxkRG9tRGF0YWtleSA9IGRvbS5wcm9wcy5jaGlsZERvbURhdGFcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvbS5jaGlsZHJlbltjaGlsZF0uZGF0YSA9IGRhdGFcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFwiZG9tRGF0YVwiIGluIGRvbS5wcm9wcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb20uY2hpbGRyZW5bY2hpbGRdLmRvbURhdGFLZXkgPSBkb20ucHJvcHMuZG9tRGF0YVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb20uY2hpbGRyZW5bY2hpbGRdLmRhdGEgPSBkYXRhW2NoaWxkXVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZG9tLmNoaWxkcmVuW2NoaWxkXS5kYXRhID0gZGF0YVxyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBvYmouY2hpbGRyZW5bY2hpbGRdID0gdGhpcy5hcHBseVRydXRoZnVsRGF0YShkb20uY2hpbGRyZW5bY2hpbGRdKVxyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gb2JqXHJcblxyXG4gICAgfVxyXG4gICAgaGFuZGxlU2luZ2xlU3R5bGUoZGF0YSwgc3R5bGUsIGRhdGFTaW5nbGUpIHtcclxuICAgICAgICBsZXQgbmV3U3R5bGUgPSAnJ1xyXG4gICAgICAgIGlmIChkYXRhU2luZ2xlKSB7XHJcbiAgICAgICAgICAgIGlmIChVdGlsLmlzUGxhY2VIb2xkZXIoc3R5bGUpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoVXRpbC5nZXRQbGFjZUhvbGRlclZhbHVlKHN0eWxlKS5pbmRleE9mKGRhdGFTaW5nbGUpICE9IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGtleSA9IFV0aWwuZ2V0UGxhY2VIb2xkZXJWYWx1ZShzdHlsZSkuc3BsaXQoXCIuXCIpWzFdXHJcbiAgICAgICAgICAgICAgICAgICAgbmV3U3R5bGUgPSBkYXRhW2tleV1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHN0eWxlS2V5ID0gc3R5bGUuc3BsaXQoXCI6XCIpWzBdXHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHN0eWxlVmFsdWUgPSBzdHlsZS5zcGxpdChcIjpcIilbMV1cclxuICAgICAgICAgICAgICAgICAgICBzdHlsZVZhbHVlID0gZGF0YVtVdGlsLmdldFBsYWNlSG9sZGVyVmFsdWUoc3R5bGVWYWx1ZSldXHJcbiAgICAgICAgICAgICAgICAgICAgbmV3U3R5bGUgPSBzdHlsZUtleSArIFwiOlwiICsgc3R5bGVWYWx1ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbmV3U3R5bGUgPSBzdHlsZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgICAgIGxldCBzdHlsZUtleSA9IHN0eWxlLnNwbGl0KFwiOlwiKVswXVxyXG4gICAgICAgICAgICBsZXQgc3R5bGVWYWx1ZSA9IHN0eWxlLnNwbGl0KFwiOlwiKVsxXVxyXG4gICAgICAgICAgICBpZiAoVXRpbC5pc1BsYWNlSG9sZGVyKHN0eWxlVmFsdWUpKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgc3R5bGVWYWx1ZSA9IGRhdGFbVXRpbC5nZXRQbGFjZUhvbGRlclZhbHVlKHN0eWxlVmFsdWUpXVxyXG4gICAgICAgICAgICAgICAgbmV3U3R5bGUgPSBzdHlsZUtleSArIFwiOlwiICsgc3R5bGVWYWx1ZVxyXG5cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG5ld1N0eWxlID0gc3R5bGVcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ld1N0eWxlXHJcbiAgICB9XHJcbiAgICBoYW5kbGVBcnJheVN0eWxlKGRhdGEsIHN0eWxlcywgZGF0YVNpbmdsZSkge1xyXG4gICAgICAgIGxldCBuZXdTdHlsZUFycmF5ID0gXCJcIlxyXG4gICAgICAgIGZvciAobGV0IHN0eWxlIG9mIHN0eWxlcykge1xyXG5cclxuICAgICAgICAgICAgbGV0IG5ld1N0eWxlID0gdGhpcy5oYW5kbGVTaW5nbGVTdHlsZShkYXRhLCBzdHlsZSwgZGF0YVNpbmdsZSlcclxuICAgICAgICAgICAgbmV3U3R5bGVBcnJheSArPSBuZXdTdHlsZSArIFwiO1wiXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXdTdHlsZUFycmF5XHJcblxyXG4gICAgfVxyXG5cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFJWIl0sInNvdXJjZVJvb3QiOiIifQ==